<!DOCTYPE html>

<html>
<head>
  <title>mootools.js</title>
  <meta http-equiv="content-type" content="text/html; charset=UTF-8">
  <meta name="viewport" content="width=device-width, target-densitydpi=160dpi, initial-scale=1.0; maximum-scale=1.0; user-scalable=0;">
  <link rel="stylesheet" media="all" href="docco.css" />
</head>
<body>
  <div id="container">
    <div id="background"></div>
    
    <ul class="sections">
        
          <li id="title">
              <div class="annotation">
                  <h1>mootools.js</h1>
              </div>
          </li>
        
        
        
        <li id="section-1">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-1">&#182;</a>
              </div>
              
            </div>
            
            <div class="content"><div class='highlight'><pre>steal(<span class="hljs-string">'can/util/can.js'</span>, <span class="hljs-string">'can/util/attr'</span>, <span class="hljs-string">'mootools'</span>, <span class="hljs-string">'can/event'</span>, <span class="hljs-string">'can/util/fragment.js'</span>, <span class="hljs-string">'can/util/deferred.js'</span>,
	<span class="hljs-string">'can/util/array/each.js'</span>, <span class="hljs-string">'can/util/object/isplain'</span>, <span class="hljs-string">"can/util/inserted"</span>, <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-params">(can, attr)</span> {</span>
		<span class="hljs-comment">/* jshint maxdepth:5 */</span></pre></div></div>
            
        </li>
        
        
        <li id="section-2">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-2">&#182;</a>
              </div>
              <h2 id="mootools-js">mootools.js</h2>

            </div>
            
        </li>
        
        
        <li id="section-3">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-3">&#182;</a>
              </div>
              <p><em>MooTools node list.</em></p>
<p>Map string helpers.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>		can.trim = <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-params">(s)</span> {</span>
			<span class="hljs-keyword">return</span> s ? s.trim() : s;
		};</pre></div></div>
            
        </li>
        
        
        <li id="section-4">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-4">&#182;</a>
              </div>
              <p>This extend() function is ruthlessly and shamelessly stolen from
jQuery 1.8.2:, lines 291-353.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>		<span class="hljs-keyword">var</span> extend = <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-params">()</span> {</span>
			<span class="hljs-keyword">var</span> options, name, src, copy, copyIsArray, clone, target = <span class="hljs-built_in">arguments</span>[<span class="hljs-number">0</span>] || {}, i = <span class="hljs-number">1</span>,
				length = <span class="hljs-built_in">arguments</span>.length,
				deep = <span class="hljs-literal">false</span>;</pre></div></div>
            
        </li>
        
        
        <li id="section-5">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-5">&#182;</a>
              </div>
              <p>Handle a deep copy situation</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>			<span class="hljs-keyword">if</span> (<span class="hljs-keyword">typeof</span> target === <span class="hljs-string">'boolean'</span>) {
				deep = target;
				target = <span class="hljs-built_in">arguments</span>[<span class="hljs-number">1</span>] || {};</pre></div></div>
            
        </li>
        
        
        <li id="section-6">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-6">&#182;</a>
              </div>
              <p>skip the boolean and the target</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>				i = <span class="hljs-number">2</span>;
			}</pre></div></div>
            
        </li>
        
        
        <li id="section-7">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-7">&#182;</a>
              </div>
              <p>Handle case when target is a string or something (possible in deep copy)</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>			<span class="hljs-keyword">if</span> (<span class="hljs-keyword">typeof</span> target !== <span class="hljs-string">'object'</span> &amp;&amp; !can.isFunction(target)) {
				target = {};
			}</pre></div></div>
            
        </li>
        
        
        <li id="section-8">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-8">&#182;</a>
              </div>
              <p>extend jQuery itself if only one argument is passed</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>			<span class="hljs-keyword">if</span> (length === i) {
				target = <span class="hljs-keyword">this</span>;
				--i;
			}
			<span class="hljs-keyword">for</span> (; i &lt; length; i++) {</pre></div></div>
            
        </li>
        
        
        <li id="section-9">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-9">&#182;</a>
              </div>
              <p>Only deal with non-null/undefined values</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>				<span class="hljs-keyword">if</span> ((options = <span class="hljs-built_in">arguments</span>[i]) !== <span class="hljs-literal">null</span>) {</pre></div></div>
            
        </li>
        
        
        <li id="section-10">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-10">&#182;</a>
              </div>
              <p>Extend the base object</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>					<span class="hljs-keyword">for</span> (name <span class="hljs-keyword">in</span> options) {
						src = target[name];
						copy = options[name];</pre></div></div>
            
        </li>
        
        
        <li id="section-11">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-11">&#182;</a>
              </div>
              <p>Prevent never-ending loop</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>						<span class="hljs-keyword">if</span> (target === copy) {
							<span class="hljs-keyword">continue</span>;
						}</pre></div></div>
            
        </li>
        
        
        <li id="section-12">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-12">&#182;</a>
              </div>
              <p>Recurse if we’re merging plain objects or arrays</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>						<span class="hljs-keyword">if</span> (deep &amp;&amp; copy &amp;&amp; (can.isPlainObject(copy) || (copyIsArray = can.isArray(copy)))) {
							<span class="hljs-keyword">if</span> (copyIsArray) {
								copyIsArray = <span class="hljs-literal">false</span>;
								clone = src &amp;&amp; can.isArray(src) ? src : [];
							} <span class="hljs-keyword">else</span> {
								clone = src &amp;&amp; can.isPlainObject(src) ? src : {};
							}</pre></div></div>
            
        </li>
        
        
        <li id="section-13">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-13">&#182;</a>
              </div>
              <p>Never move original objects, clone them</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>							target[name] = can.extend(deep, clone, copy); <span class="hljs-comment">// Don't bring in undefined values</span>
						} <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (copy !== <span class="hljs-literal">undefined</span>) {
							target[name] = copy;
						}
					}
				}
			}</pre></div></div>
            
        </li>
        
        
        <li id="section-14">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-14">&#182;</a>
              </div>
              <p>Return the modified object</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>			<span class="hljs-keyword">return</span> target;
		};
		can.extend = extend;</pre></div></div>
            
        </li>
        
        
        <li id="section-15">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-15">&#182;</a>
              </div>
              <p>Map array helpers.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>		can.makeArray = <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-params">(item)</span> {</span></pre></div></div>
            
        </li>
        
        
        <li id="section-16">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-16">&#182;</a>
              </div>
              <p>All other libraries return a copy if item is an array.
The original Mootools Array.from returned the same item so we need to slightly modify it</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>			<span class="hljs-keyword">if</span> (item === <span class="hljs-literal">null</span>) {
				<span class="hljs-keyword">return</span> [];
			}
			<span class="hljs-keyword">try</span> {
				<span class="hljs-keyword">return</span> Type.isEnumerable(item) &amp;&amp; <span class="hljs-keyword">typeof</span> item !== <span class="hljs-string">'string'</span> ? <span class="hljs-built_in">Array</span>.prototype.slice.call(item) : [item];
			} <span class="hljs-keyword">catch</span> (ex) {</pre></div></div>
            
        </li>
        
        
        <li id="section-17">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-17">&#182;</a>
              </div>
              <p>some things like DOMNodeChildCollections don’t slice so good.
This pains me, but it has to be done.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>				<span class="hljs-keyword">var</span> arr = [],
					i;
				<span class="hljs-keyword">for</span> (i = <span class="hljs-number">0</span>; i &lt; item.length; ++i) {
					arr.push(item[i]);
				}
				<span class="hljs-keyword">return</span> arr;
			}
		};
		can.isArray = <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-params">(arr)</span> {</span>
			<span class="hljs-keyword">return</span> typeOf(arr) === <span class="hljs-string">'array'</span>;
		};
		can.inArray = <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-params">(item, arr, fromIndex)</span> {</span>
			<span class="hljs-keyword">if</span> (!arr) {
				<span class="hljs-keyword">return</span> -<span class="hljs-number">1</span>;
			}
			<span class="hljs-keyword">return</span> <span class="hljs-built_in">Array</span>.prototype.indexOf.call(arr, item, fromIndex);
		};
		can.map = <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-params">(arr, fn)</span> {</span>
			<span class="hljs-keyword">return</span> <span class="hljs-built_in">Array</span>.from(arr || [])
				.map(fn);
		};</pre></div></div>
            
        </li>
        
        
        <li id="section-18">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-18">&#182;</a>
              </div>
              <p>Map object helpers.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>		can.param = <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-params">(object)</span> {</span>
			<span class="hljs-keyword">return</span> <span class="hljs-built_in">Object</span>.toQueryString(object);
		};
		can.isEmptyObject = <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-params">(object)</span> {</span>
			<span class="hljs-keyword">return</span> <span class="hljs-built_in">Object</span>.keys(object)
				.length === <span class="hljs-number">0</span>;
		};</pre></div></div>
            
        </li>
        
        
        <li id="section-19">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-19">&#182;</a>
              </div>
              <p>Map function helpers.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>		can.proxy = <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-params">()</span> {</span>
			<span class="hljs-keyword">var</span> args = can.makeArray(<span class="hljs-built_in">arguments</span>),
				func = args.shift();
			<span class="hljs-keyword">return</span> func.bind.apply(func, args);
		};
		can.isFunction = <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-params">(f)</span> {</span>
			<span class="hljs-keyword">return</span> typeOf(f) === <span class="hljs-string">'function'</span>;
		};</pre></div></div>
            
        </li>
        
        
        <li id="section-20">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-20">&#182;</a>
              </div>
              <p>Make this object so you can bind on it.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>		can.bind = <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-params">(ev, cb)</span> {</span></pre></div></div>
            
        </li>
        
        
        <li id="section-21">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-21">&#182;</a>
              </div>
              <p>If we can bind to it…</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>			<span class="hljs-keyword">if</span> (<span class="hljs-keyword">this</span>.bind &amp;&amp; <span class="hljs-keyword">this</span>.bind !== can.bind) {
				<span class="hljs-keyword">this</span>.bind(ev, cb);
			} <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (<span class="hljs-keyword">this</span>.nodeName &amp;&amp; (<span class="hljs-keyword">this</span>.nodeType &amp;&amp; <span class="hljs-keyword">this</span>.nodeType !== <span class="hljs-number">11</span>)) {
				can.$(<span class="hljs-keyword">this</span>)
					.addEvent(ev, cb);
			} <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (<span class="hljs-keyword">this</span>.addEvent) {
				<span class="hljs-keyword">this</span>.addEvent(ev, cb);
			} <span class="hljs-keyword">else</span> {</pre></div></div>
            
        </li>
        
        
        <li id="section-22">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-22">&#182;</a>
              </div>
              <p>Make it bind-able…</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>				can.addEvent.call(<span class="hljs-keyword">this</span>, ev, cb);
			}
			<span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>;
		};
		can.unbind = <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-params">(ev, cb)</span> {</span></pre></div></div>
            
        </li>
        
        
        <li id="section-23">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-23">&#182;</a>
              </div>
              <p>If we can bind to it…</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>			<span class="hljs-keyword">if</span> (<span class="hljs-keyword">this</span>.unbind &amp;&amp; <span class="hljs-keyword">this</span>.unbind !== can.unbind) {
				<span class="hljs-keyword">this</span>.unbind(ev, cb);
			} <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (<span class="hljs-keyword">this</span>.nodeName &amp;&amp; (<span class="hljs-keyword">this</span>.nodeType &amp;&amp; <span class="hljs-keyword">this</span>.nodeType !== <span class="hljs-number">11</span>)) {
				can.$(<span class="hljs-keyword">this</span>)
					.removeEvent(ev, cb);
			} <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (<span class="hljs-keyword">this</span>.removeEvent) {
				<span class="hljs-keyword">this</span>.removeEvent(ev, cb);
			} <span class="hljs-keyword">else</span> {</pre></div></div>
            
        </li>
        
        
        <li id="section-24">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-24">&#182;</a>
              </div>
              <p>Make it bind-able…</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>				can.removeEvent.call(<span class="hljs-keyword">this</span>, ev, cb);
			}
			<span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>;
		};</pre></div></div>
            
        </li>
        
        
        <li id="section-25">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-25">&#182;</a>
              </div>
              <p>Alias on/off to bind/unbind respectively</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>		can.on = can.bind;
		can.off = can.unbind;
		can.trigger = <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-params">(item, event, args, bubble)</span> {</span></pre></div></div>
            
        </li>
        
        
        <li id="section-26">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-26">&#182;</a>
              </div>
              <p>Defaults to <code>true</code>.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>			bubble = bubble === <span class="hljs-literal">undefined</span> ? <span class="hljs-literal">true</span> : bubble;
			args = args || [];
			<span class="hljs-keyword">var</span> propagating = <span class="hljs-literal">true</span>;
			<span class="hljs-keyword">if</span> (item.fireEvent) {
				item = item[<span class="hljs-number">0</span>] || item;</pre></div></div>
            
        </li>
        
        
        <li id="section-27">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-27">&#182;</a>
              </div>
              <p>walk up parents to simulate bubbling .</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>				<span class="hljs-keyword">while</span> (item &amp;&amp; propagating) {</pre></div></div>
            
        </li>
        
        
        <li id="section-28">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-28">&#182;</a>
              </div>
              <p>Handle walking yourself.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>					<span class="hljs-keyword">if</span> (!event.type) {
						event = {
							type: event,
							target: item,
							stopPropagation: <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-params">()</span> {</span>
								propagating = <span class="hljs-literal">false</span>;
							}
						};
					}
					<span class="hljs-keyword">var</span> events = item !== window ? can.$(item)
						.retrieve(<span class="hljs-string">'events'</span>)[<span class="hljs-number">0</span>] : item.retrieve(<span class="hljs-string">'events'</span>);
					<span class="hljs-keyword">if</span> (events &amp;&amp; events[event.type]) {
						events[event.type].keys.each(<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-params">(fn)</span> {</span>
							fn.apply(item, [event].concat(args));
						}, <span class="hljs-keyword">this</span>);
					}</pre></div></div>
            
        </li>
        
        
        <li id="section-29">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-29">&#182;</a>
              </div>
              <p>If we are bubbling, get parent node.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>					<span class="hljs-keyword">if</span> (bubble &amp;&amp; item.parentNode &amp;&amp; item.parentNode.nodeType !== <span class="hljs-number">11</span>) {
						item = item.parentNode;
					} <span class="hljs-keyword">else</span> {
						item = <span class="hljs-literal">null</span>;
					}
				}
			} <span class="hljs-keyword">else</span> {
				<span class="hljs-keyword">if</span> (<span class="hljs-keyword">typeof</span> event === <span class="hljs-string">'string'</span>) {
					event = {
						type: event
					};
				}
				event.target = event.target || item;
				can.dispatch.call(item, event, args);
			}
		};
		can.delegate = <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-params">(selector, ev, cb)</span> {</span>
			<span class="hljs-keyword">if</span> (<span class="hljs-keyword">this</span>.delegate) {
				<span class="hljs-keyword">this</span>.delegate(selector, ev, cb);
			} <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (<span class="hljs-keyword">this</span>.addEvent) {
				<span class="hljs-keyword">this</span>.addEvent(ev + <span class="hljs-string">':relay('</span> + selector + <span class="hljs-string">')'</span>, cb);
			} <span class="hljs-keyword">else</span> {</pre></div></div>
            
        </li>
        
        
        <li id="section-30">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-30">&#182;</a>
              </div>
              <p>make it bind-able …</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>				can.bind.call(<span class="hljs-keyword">this</span>, ev, cb);
			}
			<span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>;
		};
		can.undelegate = <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-params">(selector, ev, cb)</span> {</span>
			<span class="hljs-keyword">if</span> (<span class="hljs-keyword">this</span>.undelegate) {
				<span class="hljs-keyword">this</span>.undelegate(selector, ev, cb);
			} <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (<span class="hljs-keyword">this</span>.removeEvent) {
				<span class="hljs-keyword">this</span>.removeEvent(ev + <span class="hljs-string">':relay('</span> + selector + <span class="hljs-string">')'</span>, cb);
			} <span class="hljs-keyword">else</span> {
				can.unbind.call(<span class="hljs-keyword">this</span>, ev, cb);
			}
			<span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>;
		};
		<span class="hljs-keyword">var</span> optionsMap = {
			type: <span class="hljs-string">'method'</span>,
			success: <span class="hljs-literal">undefined</span>,
			error: <span class="hljs-literal">undefined</span>
		};
		<span class="hljs-keyword">var</span> updateDeferred = <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-params">(xhr, d)</span> {</span>
			<span class="hljs-keyword">for</span> (<span class="hljs-keyword">var</span> prop <span class="hljs-keyword">in</span> xhr) {
				<span class="hljs-keyword">if</span> (<span class="hljs-keyword">typeof</span> d[prop] === <span class="hljs-string">'function'</span>) {
					d[prop] = <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-params">()</span> {</span>
						xhr[prop].apply(xhr, <span class="hljs-built_in">arguments</span>);
					};
				} <span class="hljs-keyword">else</span> {
					d[prop] = prop[xhr];
				}
			}
		};
		can.ajax = <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-params">(options)</span> {</span>
			<span class="hljs-keyword">var</span> d = can.Deferred(),
				requestOptions = can.extend({}, options),
				request;</pre></div></div>
            
        </li>
        
        
        <li id="section-31">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-31">&#182;</a>
              </div>
              <p>Map jQuery options to MooTools options.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>			<span class="hljs-keyword">for</span> (<span class="hljs-keyword">var</span> option <span class="hljs-keyword">in</span> optionsMap) {
				<span class="hljs-keyword">if</span> (requestOptions[option] !== <span class="hljs-literal">undefined</span>) {
					requestOptions[optionsMap[option]] = requestOptions[option];
					<span class="hljs-keyword">delete</span> requestOptions[option];
				}
			}</pre></div></div>
            
        </li>
        
        
        <li id="section-32">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-32">&#182;</a>
              </div>
              <p>Mootools defaults to ‘post’, but Can expects a default of ‘get’</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>			requestOptions.method = requestOptions.method || <span class="hljs-string">'get'</span>;
			requestOptions.url = requestOptions.url.toString();
			<span class="hljs-keyword">var</span> success = options.onSuccess || options.success,
				error = options.onFailure || options.error;
			requestOptions.onSuccess = <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-params">(response, xml)</span> {</span>
				<span class="hljs-keyword">var</span> data = response;
				updateDeferred(request.xhr, d);
				d.resolve(data, <span class="hljs-string">'success'</span>, request.xhr);
				<span class="hljs-keyword">if</span> (success) {
					success(data, <span class="hljs-string">'success'</span>, request.xhr);
				}
			};
			requestOptions.onFailure = <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-params">()</span> {</span>
				updateDeferred(request.xhr, d);
				d.reject(request.xhr, <span class="hljs-string">'error'</span>);
				<span class="hljs-keyword">if</span> (error) {
					error(request.xhr, <span class="hljs-string">'error'</span>);
				}
			};
			<span class="hljs-keyword">if</span> (options.dataType === <span class="hljs-string">'json'</span>) {
				request = <span class="hljs-keyword">new</span> Request.JSON(requestOptions);
			} <span class="hljs-keyword">else</span> {
				request = <span class="hljs-keyword">new</span> Request(requestOptions);
			}
			request.send();
			updateDeferred(request.xhr, d);
			<span class="hljs-keyword">return</span> d;
		};</pre></div></div>
            
        </li>
        
        
        <li id="section-33">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-33">&#182;</a>
              </div>
              <p>Element — get the wrapped helper.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>		can.$ = <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-params">(selector)</span> {</span>
			<span class="hljs-keyword">if</span> (selector === window) {
				<span class="hljs-keyword">return</span> window;
			}
			<span class="hljs-keyword">return</span> $$(selector &amp;&amp; selector.nodeName ? [selector] : selector);
		};</pre></div></div>
            
        </li>
        
        
        <li id="section-34">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-34">&#182;</a>
              </div>
              <p>Add <code>document</code> fragment support.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>		<span class="hljs-keyword">var</span> old = document.id;
		document.id = <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-params">(el)</span> {</span>
			<span class="hljs-keyword">if</span> (el &amp;&amp; el.nodeType === <span class="hljs-number">11</span>) {
				<span class="hljs-keyword">return</span> el;
			} <span class="hljs-keyword">else</span> {
				<span class="hljs-keyword">return</span> old.apply(document, <span class="hljs-built_in">arguments</span>);
			}
		};
		can.append = <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-params">(wrapped, html)</span> {</span>
			<span class="hljs-keyword">if</span> (<span class="hljs-keyword">typeof</span> html === <span class="hljs-string">'string'</span>) {
				html = can.buildFragment(html);
			}
			<span class="hljs-keyword">return</span> wrapped.grab(html);
		};
		can.filter = <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-params">(wrapped, filter)</span> {</span>
			<span class="hljs-keyword">return</span> wrapped.filter(filter);
		};
		can.data = <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-params">(wrapped, key, value)</span> {</span>
			<span class="hljs-keyword">if</span> (value === <span class="hljs-literal">undefined</span>) {
				<span class="hljs-keyword">return</span> wrapped[<span class="hljs-number">0</span>].retrieve(key);
			} <span class="hljs-keyword">else</span> {
				<span class="hljs-keyword">return</span> wrapped.store(key, value);
			}
		};
		can.addClass = <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-params">(wrapped, className)</span> {</span>
			<span class="hljs-keyword">return</span> wrapped.addClass(className);
		};
		can.remove = <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-params">(wrapped)</span> {</span></pre></div></div>
            
        </li>
        
        
        <li id="section-35">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-35">&#182;</a>
              </div>
              <p>We need to remove text nodes ourselves.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>			<span class="hljs-keyword">var</span> filtered = wrapped.filter(<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-params">(node)</span> {</span>
				<span class="hljs-keyword">if</span> (node.nodeType !== <span class="hljs-number">1</span>) {
					node.parentNode.removeChild(node);
				} <span class="hljs-keyword">else</span> {
					<span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>;
				}
			});
			filtered.destroy();
			<span class="hljs-keyword">return</span> filtered;
		};
		can.has = <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-params">(wrapped, element)</span> {</span></pre></div></div>
            
        </li>
        
        
        <li id="section-36">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-36">&#182;</a>
              </div>
              <p>this way work in mootools</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>			<span class="hljs-keyword">if</span> (Slick.contains(wrapped[<span class="hljs-number">0</span>], element)) {
				<span class="hljs-keyword">return</span> wrapped;
			} <span class="hljs-keyword">else</span> {
				<span class="hljs-keyword">return</span> [];
			}
		};</pre></div></div>
            
        </li>
        
        
        <li id="section-37">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-37">&#182;</a>
              </div>
              <p>Destroyed method.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>		<span class="hljs-keyword">var</span> destroy = Element.prototype.destroy,
			grab = Element.prototype.grab,
			oldSet = Element.prototype.set;
		Element.implement({
			destroy: <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-params">()</span> {</span>
				can.trigger(<span class="hljs-keyword">this</span>, <span class="hljs-string">'removed'</span>, [], <span class="hljs-literal">false</span>);
				<span class="hljs-keyword">var</span> elems = <span class="hljs-keyword">this</span>.getElementsByTagName(<span class="hljs-string">'*'</span>);
				<span class="hljs-keyword">for</span> (<span class="hljs-keyword">var</span> i = <span class="hljs-number">0</span>, elem;
					(elem = elems[i]) !== <span class="hljs-literal">undefined</span>; i++) {
					can.trigger(elem, <span class="hljs-string">'removed'</span>, [], <span class="hljs-literal">false</span>);
				}
				destroy.apply(<span class="hljs-keyword">this</span>, <span class="hljs-built_in">arguments</span>);
			},
			grab: <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-params">(el)</span> {</span>
				<span class="hljs-keyword">var</span> elems;
				<span class="hljs-keyword">if</span> (el &amp;&amp; el.nodeType === <span class="hljs-number">11</span>) {
					elems = can.makeArray(el.childNodes);
				} <span class="hljs-keyword">else</span> {
					elems = [el];
				}
				<span class="hljs-keyword">var</span> ret = grab.apply(<span class="hljs-keyword">this</span>, <span class="hljs-built_in">arguments</span>);
				can.inserted(elems);
				<span class="hljs-keyword">return</span> ret;
			},
			set: <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-params">(attrName, value)</span> {</span>
				<span class="hljs-keyword">var</span> isAttributeOrProp = can.inArray(attrName, [<span class="hljs-string">"events"</span>, <span class="hljs-string">"html"</span>, <span class="hljs-string">"load"</span>, <span class="hljs-string">"morph"</span>, <span class="hljs-string">"send"</span>, <span class="hljs-string">"tag"</span>, <span class="hljs-string">"tween"</span>]) === -<span class="hljs-number">1</span>,
					newValue,
					oldValue;

				<span class="hljs-keyword">if</span> (isAttributeOrProp) {
					oldValue = <span class="hljs-keyword">this</span>.get(attrName);
				}

				<span class="hljs-keyword">var</span> res = oldSet.apply(<span class="hljs-keyword">this</span>, <span class="hljs-built_in">arguments</span>);

				<span class="hljs-keyword">if</span> (isAttributeOrProp) {
					newValue = <span class="hljs-keyword">this</span>.get(attrName);
				}
				<span class="hljs-keyword">if</span> (newValue !== oldValue) {
					can.attr.trigger(<span class="hljs-keyword">this</span>, attrName, oldValue);
				}
				<span class="hljs-keyword">return</span> res;
			}.overloadSetter()
		});
		can.get = <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-params">(wrapped, index)</span> {</span>
			<span class="hljs-keyword">return</span> wrapped[index];
		};</pre></div></div>
            
        </li>
        
        
        <li id="section-38">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-38">&#182;</a>
              </div>
              <p>Overwrite to handle IE not having an id.
IE barfs if text node.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>		<span class="hljs-keyword">var</span> idOf = Slick.uidOf;
		Slick.uidOf = <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-params">(node)</span> {</span></pre></div></div>
            
        </li>
        
        
        <li id="section-39">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-39">&#182;</a>
              </div>
              <p>for some reason, in IE8, node will be the window but not equal it.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>			<span class="hljs-keyword">if</span> (node.nodeType === <span class="hljs-number">1</span> || node === window || node.document === document) {
				<span class="hljs-keyword">return</span> idOf(node);
			} <span class="hljs-keyword">else</span> {
				<span class="hljs-keyword">return</span> <span class="hljs-built_in">Math</span>.random();
			}
		};
		Element.NativeEvents.hashchange = <span class="hljs-number">2</span>;</pre></div></div>
            
        </li>
        
        
        <li id="section-40">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-40">&#182;</a>
              </div>
              <p>Setup attributes events</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>
		can.attr = attr;</pre></div></div>
            
        </li>
        
        
        <li id="section-41">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-41">&#182;</a>
              </div>
              <p>turn off mutation events for zepto</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>		<span class="hljs-keyword">delete</span> attr.MutationObserver;

		Element.Events.attributes = {
			onAdd: <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-params">()</span> {</span>
				<span class="hljs-keyword">var</span> el = can.$(<span class="hljs-keyword">this</span>);
				can.data(el, <span class="hljs-string">"canHasAttributesBindings"</span>, (can.data(el, <span class="hljs-string">"canHasAttributesBindings"</span>) || <span class="hljs-number">0</span>) + <span class="hljs-number">1</span>);
			},
			onRemove: <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-params">()</span> {</span>
				<span class="hljs-keyword">var</span> el = can.$(<span class="hljs-keyword">this</span>),
					cur = can.data(el, <span class="hljs-string">"canHasAttributesBindings"</span>) || <span class="hljs-number">0</span>;
				<span class="hljs-keyword">if</span> (cur &lt;= <span class="hljs-number">0</span>) {
					can.cleanData(el, <span class="hljs-string">"canHasAttributesBindings"</span>);
				} <span class="hljs-keyword">else</span> {
					can.data(el, <span class="hljs-string">"canHasAttributesBindings"</span>, cur - <span class="hljs-number">1</span>);
				}
			}
		};

		<span class="hljs-keyword">return</span> can;
	});</pre></div></div>
            
        </li>
        
    </ul>
  </div>
</body>
</html>
