<!DOCTYPE html>

<html>
<head>
  <title>yui.js</title>
  <meta http-equiv="content-type" content="text/html; charset=UTF-8">
  <meta name="viewport" content="width=device-width, target-densitydpi=160dpi, initial-scale=1.0; maximum-scale=1.0; user-scalable=0;">
  <link rel="stylesheet" media="all" href="docco.css" />
</head>
<body>
  <div id="container">
    <div id="background"></div>
    
    <ul class="sections">
        
          <li id="title">
              <div class="annotation">
                  <h1>yui.js</h1>
              </div>
          </li>
        
        
        
        <li id="section-1">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-1">&#182;</a>
              </div>
              
            </div>
            
            <div class="content"><div class='highlight'><pre><span class="hljs-comment">/*
 YUI modules: http://yuilibrary.com/yui/configurator/
 node
 io-base
 querystring
 event-focus
 array-extras
 */</span></pre></div></div>
            
        </li>
        
        
        <li id="section-2">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-2">&#182;</a>
              </div>
              <p>This was used to build the custom YUI download. Re-run it to generate a new yui-<version>.js file
var yuilibs = [‘yui-base/yui-base.js’, ‘oop/oop.js’, ‘event-custom-base/event-custom-base.js’, ‘features/features.js’, ‘dom-core/dom-core.js’, ‘dom-base/dom-base.js’, ‘selector-native/selector-native.js’, ‘selector-css2/selector-css2.js’, ‘selector/selector.js’, ‘node-core/node-core.js’, ‘node-base/node-base.js’, ‘event-base/event-base.js’, ‘event-delegate/event-delegate.js’, ‘node-event-delegate/node-event-delegate.js’, ‘pluginhost-base/pluginhost-base.js’, ‘pluginhost-config/pluginhost-config.js’, ‘node-pluginhost/node-pluginhost.js’, ‘dom-style/dom-style.js’, ‘dom-screen/dom-screen.js’, ‘node-screen/node-screen.js’, ‘node-style/node-style.js’, ‘querystring-stringify-simple/querystring-stringify-simple.js’, ‘io-base/io-base.js’, ‘array-extras/array-extras.js’, ‘querystring-parse/querystring-parse.js’, ‘querystring-stringify/querystring-stringify.js’, ‘event-custom-complex/event-custom-complex.js’, ‘event-synthetic/event-synthetic.js’, ‘event-focus/event-focus.js’]</p>
<p>var url = “<a href="http://yui.yahooapis.com/combo?3.7.3/build/">http://yui.yahooapis.com/combo?3.7.3/build/</a>“ + yuilibs.join(“&amp;3.7.3/build/“)</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>
steal(<span class="hljs-string">'can/util/can.js'</span>, <span class="hljs-string">"can/util/attr"</span>, <span class="hljs-string">'yui'</span>, <span class="hljs-string">'can/event'</span>,
	<span class="hljs-string">"can/util/fragment.js"</span>, <span class="hljs-string">'can/util/array/each.js'</span>,
	<span class="hljs-string">'can/util/object/isplain'</span>, <span class="hljs-string">'can/util/deferred.js'</span>,
	<span class="hljs-string">'../hashchange.js'</span>, <span class="hljs-string">"can/util/inserted"</span>, <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-params">(can, attr)</span> </span>{</pre></div></div>
            
        </li>
        
        
        <li id="section-3">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-3">&#182;</a>
              </div>
              <p>lets overwrite </p>

            </div>
            
            <div class="content"><div class='highlight'><pre>		YUI.add(<span class="hljs-string">'can-modifications'</span>, <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-params">(Y, NAME)</span> </span>{
			<span class="hljs-keyword">var</span> addHTML = Y.DOM.addHTML;

			Y.DOM.addHTML = <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-params">(node, content, where)</span> </span>{
				<span class="hljs-keyword">if</span> (<span class="hljs-keyword">typeof</span> content === <span class="hljs-string">"string"</span> || <span class="hljs-keyword">typeof</span> content === <span class="hljs-string">"number"</span>) {
					content = can.buildFragment(content);
				}
				<span class="hljs-keyword">var</span> elems;
				<span class="hljs-keyword">if</span> (content.nodeType === <span class="hljs-number">11</span>) {
					elems = can.makeArray(content.childNodes);
				} <span class="hljs-keyword">else</span> {
					elems = [content];
				}
				<span class="hljs-keyword">var</span> ret = addHTML.call(<span class="hljs-keyword">this</span>, node, content, where);

				can.inserted(elems);

				<span class="hljs-keyword">return</span> ret;
			};

			<span class="hljs-keyword">var</span> oldOn = Y.Node.prototype.on;
			Y.Node.prototype.on = <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-params">(type, fn)</span> </span>{
				<span class="hljs-keyword">if</span> (type === <span class="hljs-string">"attributes"</span>) {</pre></div></div>
            
        </li>
        
        
        <li id="section-4">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-4">&#182;</a>
              </div>
              <p>YUI changes where the extra data comes from</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>					<span class="hljs-keyword">var</span> el = can.$(<span class="hljs-keyword">this</span>);
					can.data(el, <span class="hljs-string">"canHasAttributesBindings"</span>, (can.data(el, <span class="hljs-string">"canHasAttributesBindings"</span>) || <span class="hljs-number">0</span>) + <span class="hljs-number">1</span>);

					<span class="hljs-keyword">var</span> handle = oldOn.apply(<span class="hljs-keyword">this</span>, <span class="hljs-built_in">arguments</span>),
						oldDetach = handle.detach;
					handle.detach = <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-params">()</span> </span>{
						<span class="hljs-keyword">var</span> cur = can.data(el, <span class="hljs-string">"canHasAttributesBindings"</span>) || <span class="hljs-number">0</span>;
						<span class="hljs-keyword">if</span> (cur &lt;= <span class="hljs-number">0</span>) {
							can.cleanData(el, <span class="hljs-string">"canHasAttributesBindings"</span>);
						} <span class="hljs-keyword">else</span> {
							can.data(el, <span class="hljs-string">"canHasAttributesBindings"</span>, cur - <span class="hljs-number">1</span>);
						}
						<span class="hljs-keyword">return</span> oldDetach.apply(<span class="hljs-keyword">this</span>, <span class="hljs-built_in">arguments</span>);
					};
					<span class="hljs-keyword">return</span> handle;
				} <span class="hljs-keyword">else</span> {
					<span class="hljs-keyword">return</span> oldOn.apply(<span class="hljs-keyword">this</span>, <span class="hljs-built_in">arguments</span>);
				}
			};

		}, <span class="hljs-string">'3.7.3'</span>, {
			<span class="hljs-string">"requires"</span>: [<span class="hljs-string">"node-base"</span>]
		});</pre></div></div>
            
        </li>
        
        
        <li id="section-5">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-5">&#182;</a>
              </div>
              <hr>

            </div>
            
        </li>
        
        
        <li id="section-6">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-6">&#182;</a>
              </div>
              <p><em>YUI node list.</em>
<code>can.Y</code> is set as part of the build process.
<code>YUI().use(&#39;*&#39;)</code> is called for when <code>YUI</code> is statically loaded (like when running tests).</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>		<span class="hljs-keyword">var</span> Y = can.Y = can.Y || YUI()
			.use(<span class="hljs-string">'*'</span>);</pre></div></div>
            
        </li>
        
        
        <li id="section-7">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-7">&#182;</a>
              </div>
              <p>Map string helpers.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>		can.trim = <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-params">(s)</span> </span>{
			<span class="hljs-keyword">return</span> Y.Lang.trim(s);
		};</pre></div></div>
            
        </li>
        
        
        <li id="section-8">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-8">&#182;</a>
              </div>
              <p>Map array helpers.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>		can.makeArray = <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-params">(arr)</span> </span>{
			<span class="hljs-keyword">if</span> (!arr) {
				<span class="hljs-keyword">return</span> [];
			}
			<span class="hljs-keyword">return</span> Y.Array(arr);
		};
		can.isArray = Y.Lang.isArray;
		can.inArray = <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-params">(item, arr, fromIndex)</span> </span>{
			<span class="hljs-keyword">if</span> (!arr) {
				<span class="hljs-keyword">return</span> -<span class="hljs-number">1</span>;
			}
			<span class="hljs-keyword">return</span> Y.Array.indexOf(arr, item, fromIndex);
		};
		can.map = <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-params">(arr, fn)</span> </span>{
			<span class="hljs-keyword">return</span> Y.Array.map(can.makeArray(arr || []), fn);
		};</pre></div></div>
            
        </li>
        
        
        <li id="section-9">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-9">&#182;</a>
              </div>
              <p>Map object helpers.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>		can.extend = <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-params">(first)</span> </span>{
			<span class="hljs-keyword">var</span> deep = first === <span class="hljs-literal">true</span> ? <span class="hljs-number">1</span> : <span class="hljs-number">0</span>,
				target = <span class="hljs-built_in">arguments</span>[deep],
				i = deep + <span class="hljs-number">1</span>,
				arg;
			<span class="hljs-keyword">for</span> (; arg = <span class="hljs-built_in">arguments</span>[i]; i++) {
				Y.mix(target, arg, <span class="hljs-literal">true</span>, <span class="hljs-literal">null</span>, <span class="hljs-literal">null</span>, !!deep);
			}
			<span class="hljs-keyword">return</span> target;
		};
		can.param = <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-params">(object)</span> </span>{
			<span class="hljs-keyword">return</span> Y.QueryString.stringify(object, {
				arrayKey: <span class="hljs-literal">true</span>
			});
		};
		can.isEmptyObject = <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-params">(object)</span> </span>{
			<span class="hljs-keyword">return</span> Y.Object.isEmpty(object);
		};</pre></div></div>
            
        </li>
        
        
        <li id="section-10">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-10">&#182;</a>
              </div>
              <p>Map function helpers.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>		can.proxy = <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-params">(func, context)</span> </span>{
			<span class="hljs-keyword">return</span> Y.bind.apply(Y, <span class="hljs-built_in">arguments</span>);
		};
		can.isFunction = <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-params">(f)</span> </span>{
			<span class="hljs-keyword">return</span> Y.Lang.isFunction(f);
		};</pre></div></div>
            
        </li>
        
        
        <li id="section-11">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-11">&#182;</a>
              </div>
              <p>Element — get the wrapped helper.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>		<span class="hljs-keyword">var</span> prepareNodeList = <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-params">(nodelist)</span> </span>{
			nodelist.each(<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-params">(node, i)</span> </span>{
				nodelist[i] = node.getDOMNode();
			});
			nodelist.length = nodelist.size();
			<span class="hljs-keyword">return</span> nodelist;
		};
		can.$ = <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-params">(selector)</span> </span>{
			<span class="hljs-keyword">if</span> (selector === <span class="hljs-built_in">window</span>) {
				<span class="hljs-keyword">return</span> <span class="hljs-built_in">window</span>;
			} <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (selector <span class="hljs-keyword">instanceof</span> Y.NodeList) {
				<span class="hljs-keyword">return</span> prepareNodeList(selector);
			} <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (<span class="hljs-keyword">typeof</span> selector === <span class="hljs-string">'object'</span> &amp;&amp; !can.isArray(selector) &amp;&amp; <span class="hljs-keyword">typeof</span> selector.nodeType === <span class="hljs-string">'undefined'</span> &amp;&amp; !selector.getDOMNode) {
				<span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> Y.NodeList(selector);
			} <span class="hljs-keyword">else</span> {
				<span class="hljs-keyword">return</span> prepareNodeList(Y.all(selector));
			}
		};
		can.get = <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-params">(wrapped, index)</span> </span>{
			<span class="hljs-keyword">return</span> wrapped._nodes[index];
		};
		can.append = <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-params">(wrapped, html)</span> </span>{
			wrapped.each(<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-params">(node)</span> </span>{
				<span class="hljs-keyword">if</span> (<span class="hljs-keyword">typeof</span> html === <span class="hljs-string">'string'</span>) {
					html = can.buildFragment(html, node);
				}
				node.append(html);
			});
		};
		can.addClass = <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-params">(wrapped, className)</span> </span>{
			<span class="hljs-keyword">return</span> wrapped.addClass(className);
		};
		can.data = <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-params">(wrapped, key, value)</span> </span>{
			<span class="hljs-keyword">if</span> (value === <span class="hljs-literal">undefined</span>) {
				<span class="hljs-keyword">return</span> wrapped.item(<span class="hljs-number">0</span>)
					.getData(key);
			} <span class="hljs-keyword">else</span> {
				<span class="hljs-keyword">return</span> wrapped.item(<span class="hljs-number">0</span>)
					.setData(key, value);
			}
		};
		can.remove = <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-params">(wrapped)</span> </span>{
			<span class="hljs-keyword">return</span> wrapped.remove() &amp;&amp; wrapped.destroy();
		};
		can.has = <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-params">(wrapped, node)</span> </span>{
			<span class="hljs-keyword">if</span> (Y.DOM.contains(wrapped[<span class="hljs-number">0</span>], node)) {
				<span class="hljs-keyword">return</span> wrapped;
			} <span class="hljs-keyword">else</span> {
				<span class="hljs-keyword">return</span> [];
			}
		};</pre></div></div>
            
        </li>
        
        
        <li id="section-12">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-12">&#182;</a>
              </div>
              <p>Destroyed method.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>		can._yNodeRemove = can._yNodeRemove || Y.Node.prototype.remove;
		Y.Node.prototype.remove = <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-params">()</span> </span>{</pre></div></div>
            
        </li>
        
        
        <li id="section-13">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-13">&#182;</a>
              </div>
              <p>make sure this is only fired on normal nodes, if it
is fired on a text node, it will bubble because
the method used to stop bubbling (listening to an event)
does not work on text nodes</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>			<span class="hljs-keyword">var</span> node = <span class="hljs-keyword">this</span>.getDOMNode();
			<span class="hljs-keyword">if</span> (node.nodeType === <span class="hljs-number">1</span>) {
				can.trigger(<span class="hljs-keyword">this</span>, <span class="hljs-string">'removed'</span>, [], <span class="hljs-literal">false</span>);
				<span class="hljs-keyword">var</span> elems = node.getElementsByTagName(<span class="hljs-string">'*'</span>);
				<span class="hljs-keyword">for</span> (<span class="hljs-keyword">var</span> i = <span class="hljs-number">0</span>, elem;
						 (elem = elems[i]) !== <span class="hljs-literal">undefined</span>; i++) {
					can.trigger(elem, <span class="hljs-string">'removed'</span>, [], <span class="hljs-literal">false</span>);
				}
			}
			can._yNodeRemove.apply(<span class="hljs-keyword">this</span>, <span class="hljs-built_in">arguments</span>);
		};</pre></div></div>
            
        </li>
        
        
        <li id="section-14">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-14">&#182;</a>
              </div>
              <p>Let <code>nodelist</code> know about the new destroy…</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>		Y.NodeList.addMethod(<span class="hljs-string">'remove'</span>, Y.Node.prototype.remove);</pre></div></div>
            
        </li>
        
        
        <li id="section-15">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-15">&#182;</a>
              </div>
              <p>Ajax</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>		<span class="hljs-keyword">var</span> optionsMap = {
			type: <span class="hljs-string">'method'</span>,
			success: <span class="hljs-literal">undefined</span>,
			error: <span class="hljs-literal">undefined</span>
		};
		<span class="hljs-keyword">var</span> updateDeferred = <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-params">(request, d)</span> </span>{</pre></div></div>
            
        </li>
        
        
        <li id="section-16">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-16">&#182;</a>
              </div>
              <p><code>YUI</code> only returns a request if it is asynchronous.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>			<span class="hljs-keyword">if</span> (request &amp;&amp; request.io) {
				<span class="hljs-keyword">var</span> xhr = request.io;
				<span class="hljs-keyword">for</span> (<span class="hljs-keyword">var</span> prop <span class="hljs-keyword">in</span> xhr) {
					<span class="hljs-keyword">if</span> (<span class="hljs-keyword">typeof</span> d[prop] === <span class="hljs-string">'function'</span>) {
						d[prop] = <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-params">()</span> </span>{
							xhr[prop].apply(xhr, <span class="hljs-built_in">arguments</span>);
						};
					} <span class="hljs-keyword">else</span> {
						d[prop] = prop[xhr];
					}
				}
			}
		};
		can.ajax = <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-params">(options)</span> </span>{
			<span class="hljs-keyword">var</span> d = can.Deferred(),
				requestOptions = can.extend({}, options);
			<span class="hljs-keyword">for</span> (<span class="hljs-keyword">var</span> option <span class="hljs-keyword">in</span> optionsMap) {
				<span class="hljs-keyword">if</span> (requestOptions[option] !== <span class="hljs-literal">undefined</span>) {
					requestOptions[optionsMap[option]] = requestOptions[option];
					<span class="hljs-keyword">delete</span> requestOptions[option];
				}
			}
			requestOptions.sync = !options.async;
			<span class="hljs-keyword">var</span> success = options.success,
				error = options.error;
			requestOptions.on = {
				success: <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-params">(transactionid, response)</span> </span>{
					<span class="hljs-keyword">var</span> data = response.responseText;
					<span class="hljs-keyword">if</span> (options.dataType === <span class="hljs-string">'json'</span>) {
						data = <span class="hljs-built_in">eval</span>(<span class="hljs-string">'('</span> + data + <span class="hljs-string">')'</span>);
					}
					updateDeferred(request, d);
					d.resolve(data);
					<span class="hljs-keyword">if</span> (success) {
						success(data, <span class="hljs-string">'success'</span>, request);
					}
				},
				failure: <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-params">(transactionid, response)</span> </span>{
					updateDeferred(request, d);
					d.reject(request, <span class="hljs-string">'error'</span>);
					<span class="hljs-keyword">if</span> (error) {
						error(request, <span class="hljs-string">'error'</span>);
					}
				}
			};
			<span class="hljs-keyword">var</span> request = Y.io(requestOptions.url, requestOptions);
			updateDeferred(request, d);
			<span class="hljs-keyword">return</span> d;
		};</pre></div></div>
            
        </li>
        
        
        <li id="section-17">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-17">&#182;</a>
              </div>
              <p>Events - The <code>id</code> of the <code>function</code> to be bound, used as an expando on the <code>function</code>
so we can lookup it’s <code>remove</code> object.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>		<span class="hljs-keyword">var</span> yuiEventId = <span class="hljs-number">0</span>,</pre></div></div>
            
        </li>
        
        
        <li id="section-18">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-18">&#182;</a>
              </div>
              <p>Takes a node list, goes through each node
and adds events data that has a map of events to
<code>callbackId</code> to <code>remove</code> object.  It looks like
<code>{click: {5: {remove: fn}}}</code>.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>			addBinding = <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-params">(nodelist, selector, ev, cb)</span> </span>{
				<span class="hljs-keyword">if</span> (nodelist <span class="hljs-keyword">instanceof</span> Y.NodeList || !nodelist.on || nodelist.getDOMNode) {
					nodelist.each(<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-params">(node)</span> </span>{
						node = can.$(node);
						<span class="hljs-keyword">var</span> events = can.data(node, <span class="hljs-string">'events'</span>),
							eventName = ev + <span class="hljs-string">':'</span> + selector;
						<span class="hljs-keyword">if</span> (!events) {
							can.data(node, <span class="hljs-string">'events'</span>, events = {});
						}
						<span class="hljs-keyword">if</span> (!events[eventName]) {
							events[eventName] = {};
						}
						<span class="hljs-keyword">if</span> (cb.__bindingsIds === <span class="hljs-literal">undefined</span>) {
							cb.__bindingsIds = yuiEventId++;
						}
						events[eventName][cb.__bindingsIds] = selector ? node.item(<span class="hljs-number">0</span>)
							.delegate(ev, cb, selector) : node.item(<span class="hljs-number">0</span>)
							.on(ev, cb);
					});
				} <span class="hljs-keyword">else</span> {
					<span class="hljs-keyword">var</span> obj = nodelist,
						events = obj.__canEvents = obj.__canEvents || {};
					<span class="hljs-keyword">if</span> (!events[ev]) {
						events[ev] = {};
					}
					<span class="hljs-keyword">if</span> (cb.__bindingsIds === <span class="hljs-literal">undefined</span>) {
						cb.__bindingsIds = yuiEventId++;
					}
					events[ev][cb.__bindingsIds] = obj.on(ev, cb);
				}
			},</pre></div></div>
            
        </li>
        
        
        <li id="section-19">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-19">&#182;</a>
              </div>
              <p>Removes a binding on a <code>nodelist</code> by finding
the remove object within the object’s data.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>			removeBinding = <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-params">(nodelist, selector, ev, cb)</span> </span>{
				<span class="hljs-keyword">if</span> (nodelist <span class="hljs-keyword">instanceof</span> Y.NodeList || !nodelist.on || nodelist.getDOMNode) {
					nodelist.each(<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-params">(node)</span> </span>{
						node = can.$(node);
						<span class="hljs-keyword">var</span> events = can.data(node, <span class="hljs-string">'events'</span>);
						<span class="hljs-keyword">if</span> (events) {
							<span class="hljs-keyword">var</span> eventName = ev + <span class="hljs-string">':'</span> + selector,
								handlers = events[eventName],
								handler = handlers[cb.__bindingsIds];
							handler.detach();
							<span class="hljs-keyword">delete</span> handlers[cb.__bindingsIds];
							<span class="hljs-keyword">if</span> (can.isEmptyObject(handlers)) {
								<span class="hljs-keyword">delete</span> events[ev];
							}
							<span class="hljs-keyword">if</span> (can.isEmptyObject(events)) {
							}
						}
					});
				} <span class="hljs-keyword">else</span> {
					<span class="hljs-keyword">var</span> obj = nodelist,
						events = obj.__canEvents || {}, handlers = events[ev],
						handler = handlers[cb.__bindingsIds];
					handler.detach();
					<span class="hljs-keyword">delete</span> handlers[cb.__bindingsIds];
					<span class="hljs-keyword">if</span> (can.isEmptyObject(handlers)) {
						<span class="hljs-keyword">delete</span> events[ev];
					}
					<span class="hljs-keyword">if</span> (can.isEmptyObject(events)) {
					}
				}
			};
		can.bind = <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-params">(ev, cb)</span> </span>{</pre></div></div>
            
        </li>
        
        
        <li id="section-20">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-20">&#182;</a>
              </div>
              <p>If we can bind to it…</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>			<span class="hljs-keyword">if</span> (<span class="hljs-keyword">this</span>.bind &amp;&amp; <span class="hljs-keyword">this</span>.bind !== can.bind) {
				<span class="hljs-keyword">this</span>.bind(ev, cb);
			} <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (<span class="hljs-keyword">this</span>.on || <span class="hljs-keyword">this</span>.nodeType) {
				addBinding(can.$(<span class="hljs-keyword">this</span>), <span class="hljs-literal">undefined</span>, ev, cb);
			} <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (<span class="hljs-keyword">this</span>.addEvent) {
				<span class="hljs-keyword">this</span>.addEvent(ev, cb);
			} <span class="hljs-keyword">else</span> {</pre></div></div>
            
        </li>
        
        
        <li id="section-21">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-21">&#182;</a>
              </div>
              <p>Make it bind-able…</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>				can.addEvent.call(<span class="hljs-keyword">this</span>, ev, cb);
			}
			<span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>;
		};
		can.unbind = <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-params">(ev, cb)</span> </span>{</pre></div></div>
            
        </li>
        
        
        <li id="section-22">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-22">&#182;</a>
              </div>
              <p>If we can bind to it…</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>			<span class="hljs-keyword">if</span> (<span class="hljs-keyword">this</span>.unbind &amp;&amp; <span class="hljs-keyword">this</span>.unbind !== can.unbind) {
				<span class="hljs-keyword">this</span>.unbind(ev, cb);
			} <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (<span class="hljs-keyword">this</span>.on || <span class="hljs-keyword">this</span>.nodeType) {
				removeBinding(can.$(<span class="hljs-keyword">this</span>), <span class="hljs-literal">undefined</span>, ev, cb);
			} <span class="hljs-keyword">else</span> {</pre></div></div>
            
        </li>
        
        
        <li id="section-23">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-23">&#182;</a>
              </div>
              <p>Make it bind-able…</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>				can.removeEvent.call(<span class="hljs-keyword">this</span>, ev, cb);
			}
			<span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>;
		};</pre></div></div>
            
        </li>
        
        
        <li id="section-24">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-24">&#182;</a>
              </div>
              <p>Alias on/off to bind/unbind respectively</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>		can.on = can.bind;
		can.off = can.unbind;
		can.trigger = <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-params">(item, event, args, bubble)</span> </span>{
			<span class="hljs-keyword">if</span> (item <span class="hljs-keyword">instanceof</span> Y.NodeList) {
				item = item.item(<span class="hljs-number">0</span>);
			}
			<span class="hljs-keyword">if</span> (item.getDOMNode) {
				item = item.getDOMNode();
			}
			<span class="hljs-keyword">if</span> (item.nodeName) {
				item = Y.Node(item);
				<span class="hljs-keyword">if</span> (bubble === <span class="hljs-literal">false</span>) {</pre></div></div>
            
        </li>
        
        
        <li id="section-25">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-25">&#182;</a>
              </div>
              <p>Force stop propagation by listening to <code>on</code> and then
immediately disconnecting</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>					item.once(event, <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-params">(ev)</span> </span>{
						<span class="hljs-keyword">if</span> (ev.stopPropagation) {
							ev.stopPropagation();
						}
						ev.cancelBubble = <span class="hljs-literal">true</span>;
						<span class="hljs-keyword">if</span> (ev._stopper) {
							ev._stopper();
						}
					});
				}
				<span class="hljs-keyword">if</span> (<span class="hljs-keyword">typeof</span> event !== <span class="hljs-string">'string'</span>) {
					args = event;
					event = args.type;
					<span class="hljs-keyword">delete</span> args.type;
				}
				realTrigger(item.getDOMNode(), event, args || {});
			} <span class="hljs-keyword">else</span> {
				<span class="hljs-keyword">if</span> (<span class="hljs-keyword">typeof</span> event === <span class="hljs-string">'string'</span>) {
					event = {
						type: event
					};
				}
				event.target = event.target || item;
				can.dispatch.call(item, event, can.makeArray(args));
			}
		};</pre></div></div>
            
        </li>
        
        
        <li id="section-26">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-26">&#182;</a>
              </div>
              <p>Allow <code>dom</code> <code>destroyed</code> events.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>		Y.mix(Y.Node.DOM_EVENTS, {
			removed: <span class="hljs-literal">true</span>,
			inserted: <span class="hljs-literal">true</span>,
			attributes: <span class="hljs-literal">true</span>,</pre></div></div>
            
        </li>
        
        
        <li id="section-27">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-27">&#182;</a>
              </div>
              <p>foo is here for testing</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>			foo: <span class="hljs-literal">true</span>
		});

		Y.Env.evt.plugins.attributes = {</pre></div></div>
            
        </li>
        
        
        <li id="section-28">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-28">&#182;</a>
              </div>
              <p>forces YUI not to change this event signature</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>			on: <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-params">()</span> </span>{
				<span class="hljs-keyword">var</span> args = can.makeArray(<span class="hljs-built_in">arguments</span>);
				<span class="hljs-keyword">return</span> Y.Event._attach(args, {
					facade: <span class="hljs-literal">false</span>
				});
			}
		};

		can.delegate = <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-params">(selector, ev, cb)</span> </span>{
			<span class="hljs-keyword">if</span> (<span class="hljs-keyword">this</span>.on || <span class="hljs-keyword">this</span>.nodeType) {
				addBinding(can.$(<span class="hljs-keyword">this</span>), selector, ev, cb);
			} <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (<span class="hljs-keyword">this</span>.delegate) {
				<span class="hljs-keyword">this</span>.delegate(selector, ev, cb);
			} <span class="hljs-keyword">else</span> {</pre></div></div>
            
        </li>
        
        
        <li id="section-29">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-29">&#182;</a>
              </div>
              <p>make it bind-able …</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>				can.bind.call(<span class="hljs-keyword">this</span>, ev, cb);
			}
			<span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>;
		};
		can.undelegate = <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-params">(selector, ev, cb)</span> </span>{
			<span class="hljs-keyword">if</span> (<span class="hljs-keyword">this</span>.on || <span class="hljs-keyword">this</span>.nodeType) {
				removeBinding(can.$(<span class="hljs-keyword">this</span>), selector, ev, cb);
			} <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (<span class="hljs-keyword">this</span>.undelegate) {
				<span class="hljs-keyword">this</span>.undelegate(selector, ev, cb);
			} <span class="hljs-keyword">else</span> {
				can.unbind.call(<span class="hljs-keyword">this</span>, ev, cb);
			}
			<span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>;
		};</pre></div></div>
            
        </li>
        
        
        <li id="section-30">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-30">&#182;</a>
              </div>
              <p><code>realTrigger</code> taken from <code>dojo</code>.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>		<span class="hljs-keyword">var</span> <span class="hljs-comment">/*leaveRe = /mouse(enter|leave)/,
			_fix = function (_, p) {
				return 'mouse' + (p === 'enter' ? 'over' : 'out');
			},*/</span> realTrigger,
			realTriggerHandler = <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-params">(n, e, evdata)</span> </span>{
				<span class="hljs-keyword">var</span> node = Y.Node(n),
					handlers = can.Y.Event.getListeners(node._yuid, e),
					i;
				<span class="hljs-keyword">if</span> (handlers) {
					<span class="hljs-keyword">for</span> (i = <span class="hljs-number">0</span>; i &lt; handlers.length; i++) {
						<span class="hljs-keyword">if</span> (handlers[i].fire) {
							handlers[i].fire(evdata);
						} <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (handlers[i].handles) {
							can.each(handlers[i].handles, <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-params">(handle)</span> </span>{
								handle.evt.fire(evdata);
							});
						} <span class="hljs-keyword">else</span> {
							<span class="hljs-keyword">throw</span> <span class="hljs-string">"can not fire event"</span>;
						}
					}
				}
			},
			fakeTrigger = <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">(n, e, a)</span></span>{
				<span class="hljs-keyword">var</span> stop = <span class="hljs-literal">false</span>;</pre></div></div>
            
        </li>
        
        
        <li id="section-31">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-31">&#182;</a>
              </div>
              <p>a lame duck to work with. we’re probably a ‘custom event’</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>				<span class="hljs-keyword">var</span> evdata = can.extend({
					type: e,
					target: n,
					faux: <span class="hljs-literal">true</span>,
					_stopper: <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-params">()</span> </span>{
						stop = <span class="hljs-keyword">this</span>.cancelBubble;
					},
					stopPropagation: <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-params">()</span> </span>{
						stop = <span class="hljs-keyword">this</span>.cancelBubble;
					},
					preventDefault: <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">()</span></span>{
						
					}
				}, a);
				realTriggerHandler(n, e, evdata);
				<span class="hljs-keyword">if</span> (e === <span class="hljs-string">"inserted"</span> || e === <span class="hljs-string">"removed"</span>) {
					<span class="hljs-keyword">return</span>;
				}</pre></div></div>
            
        </li>
        
        
        <li id="section-32">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-32">&#182;</a>
              </div>
              <p>handle bubbling of custom events, unless the event was stopped.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>				<span class="hljs-keyword">while</span> (!stop &amp;&amp; n !== <span class="hljs-built_in">document</span> &amp;&amp; n.parentNode) {
					n = n.parentNode;
					realTriggerHandler(n, e, evdata); <span class="hljs-comment">//can.isFunction(n[ev]) &amp;&amp; n[ev](evdata);</span>
				}
			};
		<span class="hljs-keyword">if</span> (<span class="hljs-built_in">document</span>.createEvent) {
			realTrigger = <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-params">(n, e, a)</span> </span>{</pre></div></div>
            
        </li>
        
        
        <li id="section-33">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-33">&#182;</a>
              </div>
              <p>the same branch</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>				fakeTrigger(n, e, a);
				<span class="hljs-keyword">return</span>;
				<span class="hljs-comment">/*var ev = document.createEvent('HTMLEvents');
				e = e.replace(leaveRe, _fix);
				ev.initEvent(e, e === 'removed' || e === 'inserted' ? false : true, true);
				if (a) {
					can.extend(ev, a);
				}
				n.dispatchEvent(ev);*/</span>
			};
		} <span class="hljs-keyword">else</span> {
			realTrigger = <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-params">(n, e, a)</span> </span>{
				fakeTrigger(n, e, a);
				<span class="hljs-keyword">return</span>;
				<span class="hljs-comment">/*
</span></pre></div></div>
            
        </li>
        
        
        <li id="section-34">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-34">&#182;</a>
              </div>
              <p>the janktastic branch</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>				<span class="hljs-keyword">var</span> ev = <span class="hljs-string">'on'</span> + e;
				<span class="hljs-keyword">if</span>(e === <span class="hljs-string">"focus"</span> || e === <span class="hljs-string">"blur"</span>) {
					fakeTrigger(n, e, a);
				}
				
				<span class="hljs-keyword">try</span> {</pre></div></div>
            
        </li>
        
        
        <li id="section-35">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-35">&#182;</a>
              </div>
              <p>FIXME: is this worth it? for mixed-case native event support:? Opera ends up in the
createEvent path above, and also fails on <em>some</em> native-named events.
if(lc !== e &amp;&amp; d.indexOf(d.NodeList.events, lc) &gt;= 0){
// if the event is one of those listed in our NodeList list
// in lowercase form but is mixed case, throw to avoid
// fireEvent. /me sighs. <a href="http://gist.github.com/315318">http://gist.github.com/315318</a>
throw(“janktastic”);
}</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>					var evObj = document.createEventObject();
					if (e === "inserted" || e === "removed") {
						evObj.cancelBubble = true;
					}
					can.extend(evObj, a);
					n.fireEvent(ev, evObj);

				} catch (er) {
					fakeTrigger(n,e,a);
					
				}*/
			};
		}</pre></div></div>
            
        </li>
        
        
        <li id="section-36">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-36">&#182;</a>
              </div>
              <p>setup attributes event</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>		can.attr = attr;
		<span class="hljs-keyword">delete</span> attr.MutationObserver;

		<span class="hljs-keyword">return</span> can;
	});</pre></div></div>
            
        </li>
        
    </ul>
  </div>
</body>
</html>
