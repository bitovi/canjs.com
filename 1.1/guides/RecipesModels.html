<!DOCTYPE html>

<!--[if lt IE 7]>
<html class="no-js ie lt-ie9 lt-ie8 lt-ie7" lang="en">
<![endif]-->
<!--[if IE 7]>
<html class="no-js ie lt-ie9 lt-ie8" lang="en">
<![endif]-->
<!--[if IE 8]>
<html class="no-js ie lt-ie9" lang="en">
<![endif]-->
<!--[if IE 9]>
<html class="no-js ie ie9" lang="en">
<![endif]-->
<!--[if gt IE 9]><!-->
<html class="no-js" lang="en">
<!--<![endif]-->
<head>
	<meta charset="utf-8">
	<title>CanJS - Models </title>
	<meta name="description" content="">
	<meta name="author" content="">

	
	<link rel="stylesheet" type="text/css" href="./static/bundles/static.css">
	
	<!--[if lt IE 9]>
   <script type="text/javascript" src="static/html5shiv.js"></script>
    <!--<![endif]-->
</head>

<body class="docs ">
	<header>
		<nav class="container">

			<div class="logo-menu">
				<a class="brand" href="../../index.html">CanJS</a>
				<ul class="dropdown-menu">
		          <li><a href="http://javascriptmvc.com">JavaScriptMVC</a></li>
		          <li><a href="http://canjs.com" class="active">CanJS</a></li>
		          <li><a href="http://jquerypp.com">jQuery++</a></li>
		          <li><a href="http://stealjs.com">StealJS</a></li>
		          <li><a href="http://funcunit.com">FuncUnit</a></li>
		          <li><a href="http://documentjs.com">DocumentJS</a></li>
		        </ul>
			</div>
			
			<ul class="nav">
		        <li >
	              <a href="../../index.html">Home</a>
                </li>
		       <li class='active'><a href='index.html'>guides</a></li>
		       <li><a href='../docs/index.html'>api</a></li>
		        <li class=" community-menu">
		          <a href="../../community.html#!forums">Community</a>
		          <ul class="dropdown-menu">
		            <li><a href="https://forum.javascriptmvc.com/canjs">Forums</a></li>
		            <li><a href="http://webchat.freenode.net/?channels=canjs">IRC</a></li>
		            <li><a href="http://bitovi.bithub.com/canjs/app/">Apps</a></li>
		            <li><a href="http://bitovi.bithub.com/canjs/plugin/">Plugins</a></li>
		            <li><a href="http://bitovi.bithub.com/canjs/article/">Articles</a></li>
		            <li><a href="http://github.com/bitovi/canjs">Github</a></li>
		            <li><a href="http://twitter.com/canjs">Twitter</a></li>
		            <li><a href="http://bitovi.github.io/canjsmeetup/">Meetups</a></li>
		          </ul>
		        </li>
		        <li >
	              <a href="../../blog/index.html">Blog</a>
                </li>
		        <li >
	              <a href="../../download.html">Download</a>
                </li>
	      	</ul>
			
			<div class="pull-right">
				<div class="bitovi-menu">
					<a href="http://bitovi.com" class="bitovi icon-bits">Bitovi</a>
					<ul class="dropdown-menu">
						<li><a href="http://bitovi.com">Bitovi.com</a></li>
						<li><a href="http://bitovi.com/blog/">Blog</a></li>
						<li><a href="http://bitovi.com/consulting/">Consulting</a></li>
						<li><a href="http://bitovi.com/training/">Training</a></li>
						<li><a href="http://bitovi.com/open-source/">Open Source</a></li>
						<li><a href="http://bitovi.com/people/">People</a></li>
						<li><a href="http://bitovi.com/contact/">Contact Us</a></li>
					</ul>
				</div>
			</div>
			
		</nav>
	</header>

	
<div class="container api">

	
	<nav class="sidebar">
		
		<h2 id="version">
	<select id='versions'></select>
</h2>
<ul class="api">
	<!-- First Level -->
	
	   <li class="search-container">
	   		<a href="Tutorial.html" data-search="Getting Started">
				Getting Started
			</a>
			
	   </li>
	
	   <li class="search-container">
	   		<a href="Using.html" data-search="Using CanJS">
				Using CanJS
			</a>
			
	   </li>
	
	   <li class="search-container">
	   		<a href="Why.html" data-search="Why CanJS?">
				Why CanJS?
			</a>
			
	   </li>
	
	   <li class="search-container active">
	   		<a href="Recipes.html" data-search="Recipes">
				Recipes
			</a>
			
				
	<ul class="primary-grouping">
		
			
				
				
					<li class="search-container  ">
						<a 	class="page" 
							href="RecipesControls.html" 
							data-search="Controls">
							Controls
						</a>
						
					</li>
				
			
			
		
			
				
				
					<li class="search-container  ">
						<a 	class="page" 
							href="RecipesLiveBindings.html" 
							data-search="Live Bindings">
							Live Bindings
						</a>
						
					</li>
				
			
			
		
			
				
				
					<li class="search-container  ">
						<a 	class="page" 
							href="RecipesRouting.html" 
							data-search="Routing">
							Routing
						</a>
						
					</li>
				
			
			
		
			
				
				
					<li class="search-container active  expanded">
						<a 	class="page" 
							href="RecipesModels.html" 
							data-search="Models">
							Models
						</a>
						
							
						
					</li>
				
			
			
		
			
				
				
					<li class="search-container  ">
						<a 	class="page" 
							href="RecipesEverything.html" 
							data-search="Everything Together">
							Everything Together
						</a>
						
					</li>
				
			
			
		
	</ul>

			
	   </li>
	
	   <li class="search-container">
	   		<a href="contributing.html" data-search="How to Contribute">
				How to Contribute
			</a>
			
	   </li>
	
	   <li class="search-container">
	   		<a href="changelog.html" data-search="Changelog">
				Changelog
			</a>
			
	   </li>
	
	   <li class="search-container">
	   		<a href="license.html" data-search="License">
				License
			</a>
			
	   </li>
	
</ul>
	</nav>
	
	
	
	<article class="content docs">
	
	
		
		<section class="title">
			<div class="heading">
<h1>Models</h1>
	<ul class="tags">
		<li>page</li>
	</ul>
	
	
</div>

<div class="sub-heading">
	
	
		<span class="module">RecipesModels</span>
	
	
	
	<span class="inherits">&nbsp;</span>
</div>

<ul class="links">
    
	
		<li><a href="https://github.com/bitovi/canjs/tree/1.1-legacy/guides/recipes_models.md">source</a></li>
	
	
	
</ul>
<br />
		</section>
		
		
		
		<section class="contents">
		</section>
		
		
		

		

		
			
		
		
		
		

		
		<section class="comment">
			<p>The following recipes show how to use <code>can.Model</code> (and often the <code>can.fixture</code> plugin).</p>
<h3>Showing the same data in 2 places</h3>
<p>The following recipe shows how <code>can.Model</code>'s internal store and <code>can.view</code>'s live-binding
can easily solve the editing-data-that-is-represented-two-places problem.  It
shows two task lists of overlaping data.  Notice how the <strong>&quot;do dishes&quot;</strong> is listed
twice. But if you click one &quot;do dishes&quot; checkbox, it updates the other.</p>
<iframe style="width: 100%; height: 300px"
        src="http://jsfiddle.net/donejs/SnRKV/embedded/result,html,js,css" 
        allowfullscreen="allowfullscreen" 
        frameborder="0">JSFiddle</iframe>
<h4>How it works</h4>
<p>The code first sets up a <code>can.fixture</code> to return different, but overlapping lists of
tasks from the server.  The fixture returns data from the following calls:</p>
<ul>
<li><code>/tasks?due=today</code></li>
<li><code>/tasks?type=critical</code></li>
</ul>
<p>You'll notice &quot;do dishes&quot; in both lists.</p>
<p>The code then creates a <code>Task</code> model that maps findAll to <code>/tasks</code>.  It then uses
<code>can.view</code> to render the retrieved tasks with the <code>tasksEJS</code> template.</p>
<p>Finally, it listens when an <code>input</code> element's value changes.  When it does,
it gets the task model instance from the <code>li</code> element's <code>$.data</code> and
updates it's &quot;complete&quot; property.</p>
<p><strong><em>The Secret Sauce</em></strong></p>
<p>Model keeps an internal, non-leaking, store of instances your app loads.  When
<code>Task.findAll({type: &quot;critical&quot;})</code> and <code>Task.findAll({due: &quot;today&quot;})</code> get their
raw JSON data from the server, they convert it to instances.  But before they create
a new instance, they check if the same instance, matched by
the <a href="../docs/can.Model.id.html">id</a> property already exists.  If it
does, it uses that instance.</p>
<p>This means that the <code>criticalTasks</code> list and <code>todaysTasks</code> list both point to the
same instance. When <code>can.EJS</code> does it's live binding on <code>&lt;%= task.attr(&quot;complete&quot;) ? &quot;checked&quot; : &quot;&quot; %&gt;</code>
it's actually binding on the same &quot;do dishes&quot; intance once.  So updating &quot;do dishes&quot; updates
the DOM in two places!</p>
<h3>Caching Data in Local Storage</h3>
<p>The following recipe shows how <code>can.Model</code> can be used to create an ORM-like
model layer for keeping a local copy of a restful API. This type of base model
is perfect for situations where you want a responsive UI, but may not want to
wait for updates from the server before displaying data, or you need to make
your data persist offline. Storing your responses in <code>localStorage</code> allows you
to get data to the view as quickly as possible.</p>
<iframe style="width: 100%; height: 300px" 
        src="http://jsfiddle.net/donejs/ZhScj/embedded/result%2Cjs/" 
        allowfullscreen="allowfullscreen" 
        frameborder="0">JSFiddle</iframe>
<h4>How it works</h4>
<p>When creating your base model for other models to extend from, you can prefix
static service methods with <code>make</code>, to allow the base model to define how the
extending model's method will behave. In this example, our base model implements
a static method called <code>makeFindOne</code>. This method acts as a hook to define the
extending model's <code>findOne</code> method. Using this, we can create a middleware-like
layer between the extending model and the base model that loads and saves model
data to <code>localStorage</code>, while still requesting out to the restful API to get
updates.</p>
<p><strong><em>The Secret Sauce</em></strong></p>
<p>The secret sauce for this example is the static <code>makeFindOne</code> method along with
EJS's live binding. Because the live binding will automatically update the view when the
bound model gets updated, we can write our code as usual and allow the base model
to deliver <code>localStorage</code> data instantly, while automatically upating with responses
from the server, with no extra effort.</p>
<h3>Real Time Chat</h3>
<p>Type a message in one page, it instantly shows up in the other.</p>
<iframe style="width: 100%; height: 300px" 
        src="http://jsfiddle.net/fbasrawala/yRMSa/embedded/result%2Cjs/" 
        allowfullscreen="allowfullscreen" 
        frameborder="0">JSFiddle</iframe>
<iframe style="width: 100%; height: 300px" 
        src="http://jsfiddle.net/fbasrawala/yRMSa/embedded/result%2Cjs/" 
        allowfullscreen="allowfullscreen" 
        frameborder="0">JSFiddle</iframe>
<p><a href="http://bitovi.com/blog/2013/02/weekly-widget-chat.html">How it works</a></p>

		</section>
		
		

		
	
	
	</article>
	
	

</div>





	
	
	<footer>
		<nav class="container">
			<a class="brand" href="index.html"></a>
			<ul class='nav'>
				<li >
	              <a href="../../index.html">Home</a>
	            </li>
		        <li class='active'><a href='index.html'>guides</a></li>
		        <li><a href='../docs/index.html'>api</a></li>
		        <li class="">
		          <a href="../../community.html#!forums">Community</a>
		        </li>
		        <li >
	              <a href="../../blog/index.html">Blog</a>
	            </li>
		        <li >
	              <a href="../../download.html">Download</a>
	            </li>
            </ul>
		</nav>
	</footer>
	

    
    <script type="text/javascript">

	  var _gaq = _gaq || [];
	  _gaq.push(['_setAccount', 'UA-2302003-11']);
	  _gaq.push(['_setDomainName', 'canjs.com']);
	  _gaq.push(['_setAllowLinker', true]);
	  _gaq.push(['_trackPageview']);
	
	  (function() {
	  var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
	  ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
	  var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
	  })();
	
	</script>
	
	<script type="text/javascript">
		var docObject = {"parent":"Recipes","templates":"/Users/justin/dev/canjs.com/theme/templates","static":"/Users/justin/dev/canjs.com/theme/static","versionsSelectText":"CanJS v<%= version %>","glob":{"pattern":"{guides/*.md,*.md}","cwd":"/Users/justin/dev/canjs.com/1.1/can"},"dest":"/Users/justin/dev/canjs.com/1.1/guides","generators":["html"],"urls":{"builderData":"http://bitbuilder.herokuapp.com/canjs","builder":"http://bitbuilder.herokuapp.com/can.custom.js","bithub":"http://bitovi.bithub.com/api/v1/events/","cdn":"//canjs.com/release/","github":"https://github.com/bitovi/canjs.com"},"versions":[{"branch":"master","number":"2.1"},{"number":"2.0"},{"number":"1.1"}],"defaultDownloadVersion":"2.1.3","docConfigDest":"../../documentjs.json","project":{"version":"1.1","name":"canjs","source":"git://github.com/bitovi/canjs#1.1-legacy"},"type":"page","name":"RecipesModels","description":"","title":"Models","order":3,"comment":" ","src":"guides/recipes_models.md"};
	</script>
	
	
		<script>
		  steal = {
		    instantiated: {
		      "bundles/static.css!$css" : null
		    }
		  }
		</script>
		<script type='text/javascript' 
				data-main="static"
				src="./static/steal.production.js"
		    		bundles-path="bundles"></script>
	
	
</body>

</html>