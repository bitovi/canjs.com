<!DOCTYPE html>

<html>
<head>
  <title>key.js</title>
  <meta http-equiv="content-type" content="text/html; charset=UTF-8">
  <meta name="viewport" content="width=device-width, target-densitydpi=160dpi, initial-scale=1.0; maximum-scale=1.0; user-scalable=0;">
  <link rel="stylesheet" media="all" href="docco.css" />
</head>
<body>
  <div id="container">
    <div id="background"></div>
    
    <ul class="sections">
        
          <li id="title">
              <div class="annotation">
                  <h1>key.js</h1>
              </div>
          </li>
        
        
        
        <li id="section-1">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-1">&#182;</a>
              </div>
              
            </div>
            
            <div class="content"><div class='highlight'><pre><span class="hljs-comment">/* jshint maxdepth:5,indent:false*/</span></pre></div></div>
            
        </li>
        
        
        <li id="section-2">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-2">&#182;</a>
              </div>
              
            </div>
            
            <div class="content"><div class='highlight'><pre><span class="hljs-comment">/**
 * @documentjs-ignore
 */</span>
steal(<span class="hljs-string">'can/control/modifier'</span>, <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-params">(Control)</span> </span>{</pre></div></div>
            
        </li>
        
        
        <li id="section-3">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-3">&#182;</a>
              </div>
              <p>!steal-remove-start</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>	can.dev.warn(<span class="hljs-string">"can/control/modifier/key is an undocumented and untested plugin and will be removed in a future release."</span>);</pre></div></div>
            
        </li>
        
        
        <li id="section-4">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-4">&#182;</a>
              </div>
              <p>!steal-remove-end</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>
	<span class="hljs-comment">/*
	 * jwerty - Awesome handling of keyboard events
	 *
	 * jwerty is a JS lib which allows you to bind, fire and assert key combination
	 * strings against elements and events. It normalises the poor std api into
	 * something easy to use and clear.
	 *
	 * This code is licensed under the MIT
	 * For the full license see: http://keithamus.moit-license.org/
	 * For more information see: http://keithamus.github.com/jwerty
	 *
	 * @author Keith Cirkel ('keithamus') &lt;jwerty@keithcirkel.co.uk&gt;
	 * @license http://keithamus.mit-license.org/
	 * @copyright Copyright © 2011, Keith Cirkel
	 *
	 */</span>
	<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">realTypeOf</span><span class="hljs-params">(v, s)</span> </span>{
		<span class="hljs-keyword">return</span> v === <span class="hljs-literal">null</span> ? s === <span class="hljs-string">'null'</span> : v === <span class="hljs-literal">undefined</span> ? s === <span class="hljs-string">'undefined'</span> : v.is &amp;&amp; v <span class="hljs-keyword">instanceof</span> $ ? s === <span class="hljs-string">'element'</span> : <span class="hljs-built_in">Object</span>.prototype.toString.call(v)
			.toLowerCase()
			.indexOf(s) &gt; <span class="hljs-number">7</span>;
	}</pre></div></div>
            
        </li>
        
        
        <li id="section-5">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-5">&#182;</a>
              </div>
              <p>Private</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>	<span class="hljs-keyword">var</span> _modProps = {
		<span class="hljs-number">16</span>: <span class="hljs-string">'shiftKey'</span>,
		<span class="hljs-number">17</span>: <span class="hljs-string">'ctrlKey'</span>,
		<span class="hljs-number">18</span>: <span class="hljs-string">'altKey'</span>,
		<span class="hljs-number">91</span>: <span class="hljs-string">'metaKey'</span>
	};</pre></div></div>
            
        </li>
        
        
        <li id="section-6">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-6">&#182;</a>
              </div>
              <p>Generate key mappings for common keys that are not printable.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>	<span class="hljs-keyword">var</span> _keys = {</pre></div></div>
            
        </li>
        
        
        <li id="section-7">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-7">&#182;</a>
              </div>
              <p>MOD aka toggleable keys</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>		mods: {</pre></div></div>
            
        </li>
        
        
        <li id="section-8">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-8">&#182;</a>
              </div>
              <p>Shift key, ⇧</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>			<span class="hljs-string">'⇧'</span>: <span class="hljs-number">16</span>,
			shift: <span class="hljs-number">16</span>,</pre></div></div>
            
        </li>
        
        
        <li id="section-9">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-9">&#182;</a>
              </div>
              <p>CTRL key, on Mac: ⌃</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>			<span class="hljs-string">'⌃'</span>: <span class="hljs-number">17</span>,
			ctrl: <span class="hljs-number">17</span>,</pre></div></div>
            
        </li>
        
        
        <li id="section-10">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-10">&#182;</a>
              </div>
              <p>ALT key, on Mac: ⌥ (Alt)</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>			<span class="hljs-string">'⌥'</span>: <span class="hljs-number">18</span>,
			alt: <span class="hljs-number">18</span>,
			option: <span class="hljs-number">18</span>,</pre></div></div>
            
        </li>
        
        
        <li id="section-11">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-11">&#182;</a>
              </div>
              <p>META, on Mac: ⌘ (CMD), on Windows (Win), on Linux (Super)</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>			<span class="hljs-string">'⌘'</span>: <span class="hljs-number">91</span>,
			meta: <span class="hljs-number">91</span>,
			cmd: <span class="hljs-number">91</span>,
			<span class="hljs-string">'super'</span>: <span class="hljs-number">91</span>,
			win: <span class="hljs-number">91</span>
		},</pre></div></div>
            
        </li>
        
        
        <li id="section-12">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-12">&#182;</a>
              </div>
              <p>Normal keys</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>		keys: {</pre></div></div>
            
        </li>
        
        
        <li id="section-13">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-13">&#182;</a>
              </div>
              <p>Backspace key, on Mac: ⌫ (Backspace)</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>			<span class="hljs-string">'⌫'</span>: <span class="hljs-number">8</span>,
			backspace: <span class="hljs-number">8</span>,</pre></div></div>
            
        </li>
        
        
        <li id="section-14">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-14">&#182;</a>
              </div>
              <p>Tab Key, on Mac: ⇥ (Tab), on Windows ⇥⇥</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>			<span class="hljs-string">'⇥'</span>: <span class="hljs-number">9</span>,
			<span class="hljs-string">'⇆'</span>: <span class="hljs-number">9</span>,
			tab: <span class="hljs-number">9</span>,</pre></div></div>
            
        </li>
        
        
        <li id="section-15">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-15">&#182;</a>
              </div>
              <p>Return key, ↩</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>			<span class="hljs-string">'↩'</span>: <span class="hljs-number">13</span>,
			<span class="hljs-string">'return'</span>: <span class="hljs-number">13</span>,
			enter: <span class="hljs-number">13</span>,
			<span class="hljs-string">'⌅'</span>: <span class="hljs-number">13</span>,</pre></div></div>
            
        </li>
        
        
        <li id="section-16">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-16">&#182;</a>
              </div>
              <p>Pause/Break key</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>			<span class="hljs-string">'pause'</span>: <span class="hljs-number">19</span>,
			<span class="hljs-string">'pause-break'</span>: <span class="hljs-number">19</span>,</pre></div></div>
            
        </li>
        
        
        <li id="section-17">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-17">&#182;</a>
              </div>
              <p>Caps Lock key, ⇪</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>			<span class="hljs-string">'⇪'</span>: <span class="hljs-number">20</span>,
			caps: <span class="hljs-number">20</span>,
			<span class="hljs-string">'caps-lock'</span>: <span class="hljs-number">20</span>,</pre></div></div>
            
        </li>
        
        
        <li id="section-18">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-18">&#182;</a>
              </div>
              <p>Escape key, on Mac: ⎋, on Windows: Esc</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>			<span class="hljs-string">'⎋'</span>: <span class="hljs-number">27</span>,
			<span class="hljs-built_in">escape</span>: <span class="hljs-number">27</span>,
			esc: <span class="hljs-number">27</span>,</pre></div></div>
            
        </li>
        
        
        <li id="section-19">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-19">&#182;</a>
              </div>
              <p>Space key</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>			space: <span class="hljs-number">32</span>,</pre></div></div>
            
        </li>
        
        
        <li id="section-20">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-20">&#182;</a>
              </div>
              <p>Page-Up key, or pgup, on Mac: ↖</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>			<span class="hljs-string">'↖'</span>: <span class="hljs-number">33</span>,
			pgup: <span class="hljs-number">33</span>,
			<span class="hljs-string">'page-up'</span>: <span class="hljs-number">33</span>,</pre></div></div>
            
        </li>
        
        
        <li id="section-21">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-21">&#182;</a>
              </div>
              <p>Page-Down key, or pgdown, on Mac: ↘</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>			<span class="hljs-string">'↘'</span>: <span class="hljs-number">34</span>,
			pgdown: <span class="hljs-number">34</span>,
			<span class="hljs-string">'page-down'</span>: <span class="hljs-number">34</span>,</pre></div></div>
            
        </li>
        
        
        <li id="section-22">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-22">&#182;</a>
              </div>
              <p>END key, on Mac: ⇟</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>			<span class="hljs-string">'⇟'</span>: <span class="hljs-number">35</span>,
			end: <span class="hljs-number">35</span>,</pre></div></div>
            
        </li>
        
        
        <li id="section-23">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-23">&#182;</a>
              </div>
              <p>HOME key, on Mac: ⇞</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>			<span class="hljs-string">'⇞'</span>: <span class="hljs-number">36</span>,
			home: <span class="hljs-number">36</span>,</pre></div></div>
            
        </li>
        
        
        <li id="section-24">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-24">&#182;</a>
              </div>
              <p>Insert key, or ins</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>			ins: <span class="hljs-number">45</span>,
			insert: <span class="hljs-number">45</span>,</pre></div></div>
            
        </li>
        
        
        <li id="section-25">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-25">&#182;</a>
              </div>
              <p>Delete key, on Mac: ⌫ (Delete)</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>			del: <span class="hljs-number">46</span>,
			<span class="hljs-string">'delete'</span>: <span class="hljs-number">46</span>,</pre></div></div>
            
        </li>
        
        
        <li id="section-26">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-26">&#182;</a>
              </div>
              <p>Left Arrow Key, or ←</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>			<span class="hljs-string">'←'</span>: <span class="hljs-number">37</span>,
			left: <span class="hljs-number">37</span>,
			<span class="hljs-string">'arrow-left'</span>: <span class="hljs-number">37</span>,</pre></div></div>
            
        </li>
        
        
        <li id="section-27">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-27">&#182;</a>
              </div>
              <p>Up Arrow Key, or ↑</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>			<span class="hljs-string">'↑'</span>: <span class="hljs-number">38</span>,
			up: <span class="hljs-number">38</span>,
			<span class="hljs-string">'arrow-up'</span>: <span class="hljs-number">38</span>,</pre></div></div>
            
        </li>
        
        
        <li id="section-28">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-28">&#182;</a>
              </div>
              <p>Right Arrow Key, or →</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>			<span class="hljs-string">'→'</span>: <span class="hljs-number">39</span>,
			right: <span class="hljs-number">39</span>,
			<span class="hljs-string">'arrow-right'</span>: <span class="hljs-number">39</span>,</pre></div></div>
            
        </li>
        
        
        <li id="section-29">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-29">&#182;</a>
              </div>
              <p>Up Arrow Key, or ↓</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>			<span class="hljs-string">'↓'</span>: <span class="hljs-number">40</span>,
			down: <span class="hljs-number">40</span>,
			<span class="hljs-string">'arrow-down'</span>: <span class="hljs-number">40</span>,</pre></div></div>
            
        </li>
        
        
        <li id="section-30">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-30">&#182;</a>
              </div>
              <p>odities, printing characters that come out wrong:
Num-Multiply, or *</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>			<span class="hljs-string">'*'</span>: <span class="hljs-number">106</span>,
			star: <span class="hljs-number">106</span>,
			asterisk: <span class="hljs-number">106</span>,
			multiply: <span class="hljs-number">106</span>,</pre></div></div>
            
        </li>
        
        
        <li id="section-31">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-31">&#182;</a>
              </div>
              <p>Num-Plus or +</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>			<span class="hljs-string">'+'</span>: <span class="hljs-number">107</span>,
			<span class="hljs-string">'plus'</span>: <span class="hljs-number">107</span>,</pre></div></div>
            
        </li>
        
        
        <li id="section-32">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-32">&#182;</a>
              </div>
              <p>Num-Subtract, or -</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>			<span class="hljs-string">'-'</span>: <span class="hljs-number">109</span>,
			subtract: <span class="hljs-number">109</span>,</pre></div></div>
            
        </li>
        
        
        <li id="section-33">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-33">&#182;</a>
              </div>
              <p>Semicolon</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>			<span class="hljs-string">';'</span>: <span class="hljs-number">186</span>,
			semicolon: <span class="hljs-number">186</span>,</pre></div></div>
            
        </li>
        
        
        <li id="section-34">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-34">&#182;</a>
              </div>
              <p>= or equals</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>			<span class="hljs-string">'='</span>: <span class="hljs-number">187</span>,
			<span class="hljs-string">'equals'</span>: <span class="hljs-number">187</span>,</pre></div></div>
            
        </li>
        
        
        <li id="section-35">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-35">&#182;</a>
              </div>
              <p>Comma, or ,</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>			<span class="hljs-string">','</span>: <span class="hljs-number">188</span>,
			comma: <span class="hljs-number">188</span>,</pre></div></div>
            
        </li>
        
        
        <li id="section-36">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-36">&#182;</a>
              </div>
              <p>‘-‘: 189, //???
Period, or ., or full-stop</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>			<span class="hljs-string">'.'</span>: <span class="hljs-number">190</span>,
			period: <span class="hljs-number">190</span>,
			<span class="hljs-string">'full-stop'</span>: <span class="hljs-number">190</span>,</pre></div></div>
            
        </li>
        
        
        <li id="section-37">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-37">&#182;</a>
              </div>
              <p>Slash, or /, or forward-slash</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>			<span class="hljs-string">'/'</span>: <span class="hljs-number">191</span>,
			slash: <span class="hljs-number">191</span>,
			<span class="hljs-string">'forward-slash'</span>: <span class="hljs-number">191</span>,</pre></div></div>
            
        </li>
        
        
        <li id="section-38">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-38">&#182;</a>
              </div>
              <p>Tick, or `, or back-quote</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>			<span class="hljs-string">'`'</span>: <span class="hljs-number">192</span>,
			tick: <span class="hljs-number">192</span>,
			<span class="hljs-string">'back-quote'</span>: <span class="hljs-number">192</span>,</pre></div></div>
            
        </li>
        
        
        <li id="section-39">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-39">&#182;</a>
              </div>
              <p>Open bracket, or [</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>			<span class="hljs-string">'['</span>: <span class="hljs-number">219</span>,
			<span class="hljs-string">'open-bracket'</span>: <span class="hljs-number">219</span>,</pre></div></div>
            
        </li>
        
        
        <li id="section-40">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-40">&#182;</a>
              </div>
              <p>Back slash, or \</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>			<span class="hljs-string">'\\'</span>: <span class="hljs-number">220</span>,
			<span class="hljs-string">'back-slash'</span>: <span class="hljs-number">220</span>,</pre></div></div>
            
        </li>
        
        
        <li id="section-41">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-41">&#182;</a>
              </div>
              <p>Close backet, or ]</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>			<span class="hljs-string">']'</span>: <span class="hljs-number">221</span>,
			<span class="hljs-string">'close-bracket'</span>: <span class="hljs-number">221</span>,</pre></div></div>
            
        </li>
        
        
        <li id="section-42">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-42">&#182;</a>
              </div>
              <p>Apostraphe, or Quote, or ‘</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>			<span class="hljs-string">'\''</span>: <span class="hljs-number">222</span>,
			quote: <span class="hljs-number">222</span>,
			apostraphe: <span class="hljs-number">222</span>
		}

	}, i, n;</pre></div></div>
            
        </li>
        
        
        <li id="section-43">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-43">&#182;</a>
              </div>
              <p>To minimise code bloat, add all of the NUMPAD 0-9 keys in a loop</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>	i = <span class="hljs-number">95</span>;
	n = <span class="hljs-number">0</span>;
	<span class="hljs-keyword">while</span> (++i &lt; <span class="hljs-number">106</span>) {
		_keys.keys[<span class="hljs-string">'num-'</span> + n] = i;
		++n;
	}</pre></div></div>
            
        </li>
        
        
        <li id="section-44">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-44">&#182;</a>
              </div>
              <p>To minimise code bloat, add all of the top row 0-9 keys in a loop</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>	i = <span class="hljs-number">47</span>;
	n = <span class="hljs-number">0</span>;
	<span class="hljs-keyword">while</span> (++i &lt; <span class="hljs-number">58</span>) {
		_keys.keys[n] = i;
		++n;
	}</pre></div></div>
            
        </li>
        
        
        <li id="section-45">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-45">&#182;</a>
              </div>
              <p>To minimise code bloat, add all of the F1-F25 keys in a loop</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>	i = <span class="hljs-number">111</span>;
	n = <span class="hljs-number">1</span>;
	<span class="hljs-keyword">while</span> (++i &lt; <span class="hljs-number">136</span>) {
		_keys.keys[<span class="hljs-string">'f'</span> + n] = i;
		++n;
	}</pre></div></div>
            
        </li>
        
        
        <li id="section-46">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-46">&#182;</a>
              </div>
              <p>To minimise code bloat, add all of the letters of the alphabet in a loop</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>	i = <span class="hljs-number">64</span>;
	<span class="hljs-keyword">while</span> (++i &lt; <span class="hljs-number">91</span>) {
		_keys.keys[<span class="hljs-built_in">String</span>.fromCharCode(i)
			.toLowerCase()] = i;
	}

	<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">JwertyCode</span><span class="hljs-params">(jwertyCode)</span> </span>{
		<span class="hljs-keyword">var</span> i, c, n, z, keyCombo, optionals, jwertyCodeFragment, rangeMatches, rangeI;</pre></div></div>
            
        </li>
        
        
        <li id="section-47">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-47">&#182;</a>
              </div>
              <p>In-case we get called with an instance of ourselves, just return that.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>		<span class="hljs-keyword">if</span> (jwertyCode <span class="hljs-keyword">instanceof</span> JwertyCode) {
			<span class="hljs-keyword">return</span> jwertyCode;
		}</pre></div></div>
            
        </li>
        
        
        <li id="section-48">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-48">&#182;</a>
              </div>
              <p>If jwertyCode isn’t an array, cast it as a string and split into array.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>		<span class="hljs-keyword">if</span> (!realTypeOf(jwertyCode, <span class="hljs-string">'array'</span>)) {
			jwertyCode = <span class="hljs-built_in">String</span>(jwertyCode)
				.replace(<span class="hljs-regexp">/\s/g</span>, <span class="hljs-string">''</span>)
				.toLowerCase()
				.match(<span class="hljs-regexp">/(?:\+,|[^,])+/g</span>);
		}</pre></div></div>
            
        </li>
        
        
        <li id="section-49">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-49">&#182;</a>
              </div>
              <p>Loop through each key sequence in jwertyCode</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>		<span class="hljs-keyword">for</span> (i = <span class="hljs-number">0</span>, c = jwertyCode.length; i &lt; c; ++i) {</pre></div></div>
            
        </li>
        
        
        <li id="section-50">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-50">&#182;</a>
              </div>
              <p>If the key combo at this part of the sequence isn’t an array,
cast as a string and split into an array.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>			<span class="hljs-keyword">if</span> (!realTypeOf(jwertyCode[i], <span class="hljs-string">'array'</span>)) {
				jwertyCode[i] = <span class="hljs-built_in">String</span>(jwertyCode[i])
					.match(<span class="hljs-regexp">/(?:\+\/|[^\/])+/g</span>);
			}</pre></div></div>
            
        </li>
        
        
        <li id="section-51">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-51">&#182;</a>
              </div>
              <p>Parse the key optionals in this sequence</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>			optionals = [];
			n = jwertyCode[i].length;
			<span class="hljs-keyword">while</span> (n--) {</pre></div></div>
            
        </li>
        
        
        <li id="section-52">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-52">&#182;</a>
              </div>
              <p>Begin creating the object for this key combo</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>				jwertyCodeFragment = jwertyCode[i][n];
				keyCombo = {
					jwertyCombo: <span class="hljs-built_in">String</span>(jwertyCodeFragment),
					shiftKey: <span class="hljs-literal">false</span>,
					ctrlKey: <span class="hljs-literal">false</span>,
					altKey: <span class="hljs-literal">false</span>,
					metaKey: <span class="hljs-literal">false</span>
				};</pre></div></div>
            
        </li>
        
        
        <li id="section-53">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-53">&#182;</a>
              </div>
              <p>If jwertyCodeFragment isn’t an array then cast as a string
and split it into one.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>				<span class="hljs-keyword">if</span> (!realTypeOf(jwertyCodeFragment, <span class="hljs-string">'array'</span>)) {
					jwertyCodeFragment = <span class="hljs-built_in">String</span>(jwertyCodeFragment)
						.toLowerCase()
						.match(<span class="hljs-regexp">/(?:(?:[^\+])+|\+\+|^\+$)/g</span>);
				}
				z = jwertyCodeFragment.length;
				<span class="hljs-keyword">while</span> (z--) {</pre></div></div>
            
        </li>
        
        
        <li id="section-54">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-54">&#182;</a>
              </div>
              <p>Normalise matching errors</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>					<span class="hljs-keyword">if</span> (jwertyCodeFragment[z] === <span class="hljs-string">'++'</span>) {
						jwertyCodeFragment[z] = <span class="hljs-string">'+'</span>;
					}</pre></div></div>
            
        </li>
        
        
        <li id="section-55">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-55">&#182;</a>
              </div>
              <p>Inject either keyCode or ctrl/meta/shift/altKey into keyCombo</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>					<span class="hljs-keyword">if</span> (jwertyCodeFragment[z] <span class="hljs-keyword">in</span> _keys.mods) {
						keyCombo[_modProps[_keys.mods[jwertyCodeFragment[z]]]] = <span class="hljs-literal">true</span>;
					} <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (jwertyCodeFragment[z] <span class="hljs-keyword">in</span> _keys.keys) {
						keyCombo.keyCode = _keys.keys[jwertyCodeFragment[z]];
					} <span class="hljs-keyword">else</span> {
						rangeMatches = jwertyCodeFragment[z].match(<span class="hljs-regexp">/^\[([^-]+\-?[^-]*)-([^-]+\-?[^-]*)\]$/</span>);
					}
				}
				<span class="hljs-keyword">if</span> (realTypeOf(keyCombo.keyCode, <span class="hljs-string">'undefined'</span>)) {</pre></div></div>
            
        </li>
        
        
        <li id="section-56">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-56">&#182;</a>
              </div>
              <p>If we picked up a range match earlier…</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>					<span class="hljs-keyword">if</span> (rangeMatches &amp;&amp; rangeMatches[<span class="hljs-number">1</span>] <span class="hljs-keyword">in</span> _keys.keys &amp;&amp; rangeMatches[<span class="hljs-number">2</span>] <span class="hljs-keyword">in</span> _keys.keys) {
						rangeMatches[<span class="hljs-number">2</span>] = _keys.keys[rangeMatches[<span class="hljs-number">2</span>]];
						rangeMatches[<span class="hljs-number">1</span>] = _keys.keys[rangeMatches[<span class="hljs-number">1</span>]];</pre></div></div>
            
        </li>
        
        
        <li id="section-57">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-57">&#182;</a>
              </div>
              <p>Go from match 1 and capture all key-comobs up to match 2</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>						<span class="hljs-keyword">for</span> (rangeI = rangeMatches[<span class="hljs-number">1</span>]; rangeI &lt; rangeMatches[<span class="hljs-number">2</span>]; ++rangeI) {
							optionals.push({
								altKey: keyCombo.altKey,
								shiftKey: keyCombo.shiftKey,
								metaKey: keyCombo.metaKey,
								ctrlKey: keyCombo.ctrlKey,
								keyCode: rangeI,
								jwertyCombo: <span class="hljs-built_in">String</span>(jwertyCodeFragment)
							});
						}
						keyCombo.keyCode = rangeI; <span class="hljs-comment">// Inject either keyCode or ctrl/meta/shift/altKey into keyCombo</span>
					} <span class="hljs-keyword">else</span> {
						keyCombo.keyCode = <span class="hljs-number">0</span>;
					}
				}
				optionals.push(keyCombo);
			}
			<span class="hljs-keyword">this</span>[i] = optionals;
		}
		<span class="hljs-keyword">this</span>.length = i;
		<span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>;
	}
	<span class="hljs-keyword">var</span> jwerty = {

		<span class="hljs-comment">/**
		 * jwerty.event
		 *
		 * `jwerty.event` will return a function, which expects the first
		 *  argument to be a key event. When the key event matches `jwertyCode`,
		 *  `callbackFunction` is fired. `jwerty.event` is used by `jwerty.key`
		 *  to bind the function it returns. `jwerty.event` is useful for
		 *  attaching to your own event listeners. It can be used as a decorator
		 *  method to encapsulate functionality that you only want to fire after
		 *  a specific key combo. If `callbackContext` is specified then it will
		 *  be supplied as `callbackFunction`'s context - in other words, the
		 *  keyword `this` will be set to `callbackContext` inside the
		 *  `callbackFunction` function.
		 *
		 *   @param {Array|String} jwertyCode can be an array, or string of key
		 *      combinations, which includes optionals and or sequences
		 *   @param {Function} callbackFunction is a function (or boolean) which
		 *      is fired when jwertyCode is matched. Return false to
		 *      preventDefault()
		 *   @param {Object} [callbackContext] The context to call
		 *      `callback` with (i.e this)
		 *
		 */</span>
		event: <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-params">(jwertyCode, callbackFunction, callbackContext <span class="hljs-comment">/*? this */</span> )</span> </span>{</pre></div></div>
            
        </li>
        
        
        <li id="section-58">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-58">&#182;</a>
              </div>
              <p>Construct a function out of callbackFunction, if it is a boolean.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>			<span class="hljs-keyword">if</span> (realTypeOf(callbackFunction, <span class="hljs-string">'boolean'</span>)) {
				<span class="hljs-keyword">var</span> bool = callbackFunction;
				callbackFunction = <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-params">()</span> </span>{
					<span class="hljs-keyword">return</span> bool;
				};
			}
			jwertyCode = <span class="hljs-keyword">new</span> JwertyCode(jwertyCode);</pre></div></div>
            
        </li>
        
        
        <li id="section-59">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-59">&#182;</a>
              </div>
              <p>Initialise in-scope vars.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>			<span class="hljs-keyword">var</span> i = <span class="hljs-number">0</span>,
				c = jwertyCode.length - <span class="hljs-number">1</span>,
				returnValue, jwertyCodeIs;</pre></div></div>
            
        </li>
        
        
        <li id="section-60">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-60">&#182;</a>
              </div>
              <p>This is the event listener function that gets returned…</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>			<span class="hljs-keyword">return</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-params">(event)</span> </span>{
				jwertyCodeIs = jwerty.is(jwertyCode, event, i);</pre></div></div>
            
        </li>
        
        
        <li id="section-61">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-61">&#182;</a>
              </div>
              <p>if jwertyCodeIs returns truthy (string)…</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>				<span class="hljs-keyword">if</span> (jwertyCodeIs) {</pre></div></div>
            
        </li>
        
        
        <li id="section-62">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-62">&#182;</a>
              </div>
              <p>… and this isn’t the last key in the sequence,
incriment the key in sequence to check.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>					<span class="hljs-keyword">if</span> (i &lt; c) {
						++i;
						<span class="hljs-keyword">return</span>; <span class="hljs-comment">// ... and this is the last in the sequence (or the only</span></pre></div></div>
            
        </li>
        
        
        <li id="section-63">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-63">&#182;</a>
              </div>
              <p>one in sequence), then fire the callback</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>					} <span class="hljs-keyword">else</span> {
						returnValue = callbackFunction.call(callbackContext || <span class="hljs-keyword">this</span>, event, jwertyCodeIs);</pre></div></div>
            
        </li>
        
        
        <li id="section-64">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-64">&#182;</a>
              </div>
              <p>If the callback returned false, then we should run
preventDefault();</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>						<span class="hljs-keyword">if</span> (returnValue === <span class="hljs-literal">false</span>) {
							event.preventDefault();
						}</pre></div></div>
            
        </li>
        
        
        <li id="section-65">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-65">&#182;</a>
              </div>
              <p>Reset i for the next sequence to fire.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>						i = <span class="hljs-number">0</span>;
						<span class="hljs-keyword">return</span>;
					}
				}</pre></div></div>
            
        </li>
        
        
        <li id="section-66">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-66">&#182;</a>
              </div>
              <p>If the event didn’t hit this time, we should reset i to 0,
that is, unless this combo was the first in the sequence,
in which case we should reset i to 1.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>				i = jwerty.is(jwertyCode, event) ? <span class="hljs-number">1</span> : <span class="hljs-number">0</span>;
			};
		},

		<span class="hljs-comment">/**
		 * jwerty.is
		 *
		 * `jwerty.is` will return a boolean value, based on if `event` matches
		 *  `jwertyCode`. `jwerty.is` is called by `jwerty.event` to check
		 *  whether or not to fire the callback. `event` can be a DOM event, or
		 *  a jQuery/Zepto/Ender manufactured event. The properties of
		 *  `jwertyCode` (speficially ctrlKey, altKey, metaKey, shiftKey and
		 *  keyCode) should match `jwertyCode`'s properties - if they do, then
		 *  `jwerty.is` will return `true`. If they don't, `jwerty.is` will
		 *  return `false`.
		 *
		 *   @param {Array|String} jwertyCode can be an array, or string of key
		 *      combinations, which includes optionals and or sequences
		 *   @param {KeyboardEvent} event is the KeyboardEvent to assert against
		 *   @param {Integer} [i] checks the `i` key in jwertyCode
		 *      sequence
		 *
		 */</span>
		is: <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-params">(jwertyCode, event, i <span class="hljs-comment">/*? 0*/</span> )</span> </span>{
			jwertyCode = <span class="hljs-keyword">new</span> JwertyCode(jwertyCode);</pre></div></div>
            
        </li>
        
        
        <li id="section-67">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-67">&#182;</a>
              </div>
              <p>Default <code>i</code> to 0</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>			i = i || <span class="hljs-number">0</span>;</pre></div></div>
            
        </li>
        
        
        <li id="section-68">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-68">&#182;</a>
              </div>
              <p>We are only interesting in <code>i</code> of jwertyCode;</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>			jwertyCode = jwertyCode[i];</pre></div></div>
            
        </li>
        
        
        <li id="section-69">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-69">&#182;</a>
              </div>
              <p>jQuery stores the <em>real</em> event in <code>originalEvent</code>, which we use
because it does annoything stuff to <code>metaKey</code></p>

            </div>
            
            <div class="content"><div class='highlight'><pre>			event = event.originalEvent || event;</pre></div></div>
            
        </li>
        
        
        <li id="section-70">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-70">&#182;</a>
              </div>
              <p>We’ll look at each optional in this jwertyCode sequence…</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>			<span class="hljs-keyword">var</span> n = jwertyCode.length,
				returnValue = <span class="hljs-literal">false</span>;</pre></div></div>
            
        </li>
        
        
        <li id="section-71">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-71">&#182;</a>
              </div>
              <p>Loop through each fragment of jwertyCode</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>			<span class="hljs-keyword">while</span> (n--) {
				returnValue = jwertyCode[n].jwertyCombo;</pre></div></div>
            
        </li>
        
        
        <li id="section-72">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-72">&#182;</a>
              </div>
              <p>For each property in the jwertyCode object, compare to <code>event</code></p>

            </div>
            
            <div class="content"><div class='highlight'><pre>				<span class="hljs-keyword">for</span> (<span class="hljs-keyword">var</span> p <span class="hljs-keyword">in</span> jwertyCode[n]) {</pre></div></div>
            
        </li>
        
        
        <li id="section-73">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-73">&#182;</a>
              </div>
              <p>…except for jwertyCode.jwertyCombo…</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>					<span class="hljs-keyword">if</span> (p !== <span class="hljs-string">'jwertyCombo'</span> &amp;&amp; event[p] !== jwertyCode[n][p]) {
						returnValue = <span class="hljs-literal">false</span>;
					}
				}</pre></div></div>
            
        </li>
        
        
        <li id="section-74">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-74">&#182;</a>
              </div>
              <p>If this jwertyCode optional wasn’t falsey, then we can return early.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>				<span class="hljs-keyword">if</span> (returnValue !== <span class="hljs-literal">false</span>) {
					<span class="hljs-keyword">return</span> returnValue;
				}
			}
			<span class="hljs-keyword">return</span> returnValue;
		},
		KEYS: _keys
	};
	<span class="hljs-comment">/**
	 * @page can.control.key
	 * @parent can.control
	 *
	 * Add templated event binding with keydown specific binding.
	 * For example, the following would bind to keydown on "CTRL+P".
	 *
	 *      "keydown:(ctrl+p)":function(elm,ev){ ... }
	 *
	 * Uses a modified version of 'jwerty' for its key finding.
	 *
	 */</span></pre></div></div>
            
        </li>
        
        
        <li id="section-75">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-75">&#182;</a>
              </div>
              <p>Hang on to original action</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>	<span class="hljs-keyword">var</span> originalShifter = can.Control._shifter;</pre></div></div>
            
        </li>
        
        
        <li id="section-76">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-76">&#182;</a>
              </div>
              <p>Redefine _isAction to handle new syntax</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>	can.extend(can.Control, {
		_shifter: <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-params">(context, name)</span> </span>{
			<span class="hljs-keyword">var</span> fn = originalShifter.apply(<span class="hljs-keyword">this</span>, <span class="hljs-built_in">arguments</span>),
				parts = name.split(<span class="hljs-string">':'</span>);
			<span class="hljs-keyword">if</span> (parts.length &gt; <span class="hljs-number">1</span> &amp;&amp; <span class="hljs-regexp">/key/</span>.test(parts[<span class="hljs-number">0</span>])) {
				<span class="hljs-keyword">if</span> (parts[<span class="hljs-number">1</span>][<span class="hljs-number">0</span>] === <span class="hljs-string">'('</span>) {</pre></div></div>
            
        </li>
        
        
        <li id="section-77">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-77">&#182;</a>
              </div>
              <p>Make sure the first char after the ‘:’ is a param
this is for cases like “keydown:debounce(50)”:function() { … }</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>					fn = jwerty.event(parts[<span class="hljs-number">1</span>].replace(<span class="hljs-regexp">/\(|\)/gi</span>, <span class="hljs-string">''</span>), fn);
				}
			}
			<span class="hljs-keyword">return</span> fn;
		}
	});
});</pre></div></div>
            
        </li>
        
    </ul>
  </div>
</body>
</html>
