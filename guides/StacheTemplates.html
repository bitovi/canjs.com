<!DOCTYPE html>

<!--[if lt IE 7]>
<html class="no-js ie lt-ie9 lt-ie8 lt-ie7" lang="en">
<![endif]-->
<!--[if IE 7]>
<html class="no-js ie lt-ie9 lt-ie8" lang="en">
<![endif]-->
<!--[if IE 8]>
<html class="no-js ie lt-ie9" lang="en">
<![endif]-->
<!--[if IE 9]>
<html class="no-js ie ie9" lang="en">
<![endif]-->
<!--[if gt IE 9]><!-->
<html class="no-js" lang="en">
<!--<![endif]-->
<head>
	<meta charset="utf-8">
	<title>CanJS - Stache Templates </title>
	<meta name="description" content="">
	<meta name="author" content="">

	
	<link rel="stylesheet" type="text/css" href="./static/bundles/static.css">
	
	<!--[if lt IE 9]>
   <script type="text/javascript" src="static/html5shiv.js"></script>
    <!--<![endif]-->
</head>

<body class="docs ">
	<header>
		<nav class="container">

			<div class="logo-menu">
				<a class="brand" href="../index.html">CanJS</a>
				<ul class="dropdown-menu">
				  <li><a href="http://donejs.com">DoneJS</a></li>
		          <li><a href="http://canjs.com" class="active">CanJS</a></li>
		          <li><a href="http://jquerypp.com">jQuery++</a></li>
		          <li><a href="http://stealjs.com">StealJS</a></li>
		          <li><a href="http://funcunit.com">FuncUnit</a></li>
		          <li><a href="http://documentjs.com">DocumentJS</a></li>
		        </ul>
			</div>

			<ul class="nav">
		        <li >
	              <a href="../index.html">Home</a>
                </li>
		       <li class='active'><a href='index.html'>guides</a></li>
		       <li><a href='../docs/index.html'>api</a></li>
		        <li class=" community-menu">
		          <a href="javascript://">Community</a>
		          <ul class="dropdown-menu">
		            <li><a href="http://forums.donejs.com/c/canjs">Forums</a></li>
		            <li><a href="https://www.npmjs.com/search?q=canjs">Plugins</a></li>
		            <li><a href="http://github.com/canjs/canjs">Github</a></li>
		            <li><a href="http://twitter.com/canjs">Twitter</a></li>
		            <li><a href="http://donejs.com/community.html">Meetups</a></li>
		          </ul>
		        </li>
		        <li>
	              <a href="http://blog.bitovi.com/category/open-source/">Blog</a>
                </li>
		        <li >
	              <a href="../download.html">Download</a>
                </li>
	      	</ul>

			<div class="pull-right">
				<div class="bitovi-menu">
					<a href="http://bitovi.com" class="bitovi icon-bits">Bitovi</a>
					<ul class="dropdown-menu">
						<li><a href="http://bitovi.com">Bitovi.com</a></li>
						<li><a href="http://bitovi.com/blog/">Blog</a></li>
						<li><a href="http://bitovi.com/design/">Design</a></li>
						<li><a href="http://bitovi.com/development/">Development</a></li>
						<li><a href="http://bitovi.com/training/">Training</a></li>
						<li><a href="http://bitovi.com/open-source/">Open Source</a></li>
						<li><a href="http://bitovi.com/people/">People</a></li>
						<li><a href="http://bitovi.com/contact/">Contact Us</a></li>
					</ul>
				</div>
			</div>

		</nav>
	</header>

	
<div class="container api">

	
	<nav class="sidebar">
		
		<h2 id="version">
	<select id='versions'></select>
</h2>
<ul class="api">
	<!-- First Level -->
	
	   <li class="search-container">
	   		<a href="Why.html" data-search="Why CanJS?">
				Why CanJS?
			</a>
			
	   </li>
	
	   <li class="search-container">
	   		<a href="Using.html" data-search="Setting up CanJS">
				Setting up CanJS
			</a>
			
	   </li>
	
	   <li class="search-container active">
	   		<a href="Tutorial.html" data-search="Getting Started Tutorial">
				Getting Started Tutorial
			</a>
			
				
	<ul class="primary-grouping">
		
			
				
				
					<li class="search-container  ">
						<a 	class="page" 
							href="Setup.html" 
							data-search="Setup">
							Setup
						</a>
						
					</li>
				
			
			
		
			
				
				
					<li class="search-container  ">
						<a 	class="page" 
							href="ApplicationDesign.html" 
							data-search="Application Design">
							Application Design
						</a>
						
					</li>
				
			
			
		
			
				
				
					<li class="search-container  ">
						<a 	class="page" 
							href="Constructors.html" 
							data-search="Constructors">
							Constructors
						</a>
						
					</li>
				
			
			
		
			
				
				
					<li class="search-container  ">
						<a 	class="page" 
							href="Observables.html" 
							data-search="Observables">
							Observables
						</a>
						
					</li>
				
			
			
		
			
				
				
					<li class="search-container  ">
						<a 	class="page" 
							href="TheDefinePlugin.html" 
							data-search="The Define Plugin">
							The Define Plugin
						</a>
						
					</li>
				
			
			
		
			
				
				
					<li class="search-container active  expanded">
						<a 	class="page" 
							href="StacheTemplates.html" 
							data-search="Stache Templates">
							Stache Templates
						</a>
						
							
						
					</li>
				
			
			
		
			
				
				
					<li class="search-container  ">
						<a 	class="page" 
							href="AppStateAndRouting.html" 
							data-search="App State and Routing">
							App State and Routing
						</a>
						
					</li>
				
			
			
		
			
				
				
					<li class="search-container  ">
						<a 	class="page" 
							href="Components.html" 
							data-search="Components">
							Components
						</a>
						
					</li>
				
			
			
		
			
				
				
					<li class="search-container  ">
						<a 	class="page" 
							href="ViewModels.html" 
							data-search="View Models">
							View Models
						</a>
						
					</li>
				
			
			
		
			
				
				
					<li class="search-container  ">
						<a 	class="page" 
							href="DataModelsAndFixtures.html" 
							data-search="Data Models and Fixtures">
							Data Models and Fixtures
						</a>
						
					</li>
				
			
			
		
			
				
				
					<li class="search-container  ">
						<a 	class="page" 
							href="Routing.html" 
							data-search="Routing">
							Routing
						</a>
						
					</li>
				
			
			
		
			
				
				
					<li class="search-container  ">
						<a 	class="page" 
							href="LoadingStates.html" 
							data-search="Loading States">
							Loading States
						</a>
						
					</li>
				
			
			
		
			
				
				
					<li class="search-container  ">
						<a 	class="page" 
							href="EventHandling.html" 
							data-search="Event Handling">
							Event Handling
						</a>
						
					</li>
				
			
			
		
			
				
				
					<li class="search-container  ">
						<a 	class="page" 
							href="WebServiceCommunication.html" 
							data-search="Web Service Communication">
							Web Service Communication
						</a>
						
					</li>
				
			
			
		
			
				
				
					<li class="search-container  ">
						<a 	class="page" 
							href="Recap.html" 
							data-search="Recap">
							Recap
						</a>
						
					</li>
				
			
			
		
	</ul>

			
	   </li>
	
	   <li class="search-container">
	   		<a href="Recipes.html" data-search="Recipes">
				Recipes
			</a>
			
	   </li>
	
	   <li class="search-container">
	   		<a href="contributing.html" data-search="How to Contribute">
				How to Contribute
			</a>
			
	   </li>
	
	   <li class="search-container">
	   		<a href="changelog.html" data-search="Changelog">
				Changelog
			</a>
			
	   </li>
	
	   <li class="search-container">
	   		<a href="license.html" data-search="License">
				License
			</a>
			
	   </li>
	
	   <li class="search-container">
	   		<a href="migrating.html" data-search="Migrating to 2.0">
				Migrating to 2.0
			</a>
			
	   </li>
	
	   <li class="search-container">
	   		<a href="roadmap.html" data-search="Roadmap">
				Roadmap
			</a>
			
	   </li>
	
</ul>
	</nav>
	
	
	
	<article class="content docs">
	
	
		
		<section class="title">
			<div class="heading">
<h1>Stache Templates</h1>
	<ul class="tags">
		<li>page</li>
	</ul>
	
	
</div>

<div class="sub-heading">
	
	
		<span class="module">StacheTemplates</span>
	
	
	
	<span class="inherits">&nbsp;</span>
</div>

<ul class="links">
	
	
		<li><a href="https://github.com/canjs/canjs/tree/2.3-legacy/guides/getting-started-tutorial/stache-templates.md">source</a></li>
	
	
	
</ul>
<br />
		</section>
		
		
		
		<section class="contents">
		</section>
		
		
		

		

		
			
		
		
		
		

		
		<section class="comment">
			<div class="getting-started">
<hr />
<p><strong>In this Chapter</strong></p>
<ul>
<li>Stache Templates</li>
</ul>
<p>Get the code for: <a href="/guides/examples/PlaceMyOrder/ch-2_canjs-getting-started.zip">chapter: stache templates</a></p>
<hr />
<p>Now that we have a basic sketch of our application, and we've covered a few CanJS fundamentals,
it’s time for us to start working with the sample application. We'll begin with the
application's templates.</p>
<p>As mentioned in the <a href="./Tutorial.html">introduction</a>, we’re using Stache templates in
our app. Remember that when we downloaded our custom build of CanJS, we
included the <a href="../docs/can.stache.html">can.stache</a> plugin.</p>
<p>We can create a simple template, render it to a document fragment and insert it into the page like
the following:</p>
<pre><code>var template = can.stache(&quot;&lt;h1&gt;{{message}}&lt;/h1&gt;&quot;);
var frag = template({message: &quot;Hello World&quot;});
$(&quot;body&quot;).append(frag);
</code></pre>
<p>Stache templates look similar to normal HTML, except they contain magic tags that contain
a very simple language that can be used to:</p>
<ul>
<li><a href="#context">lookup and insert values into the html output</a></li>
<li><a href="#enumeration">loop over arrays and can.Lists</a></li>
<li><a href="#conditionallogic">control-flow behavior like if and switch</a></li>
<li><a href="#partials">render other templates with partials</a></li>
<li>perform custom control-flow behavior</li>
</ul>
<p>Stache templates support both <a href="https://github.com/janl/mustache.js/">Mustache</a>
and <a href="http://handlebarsjs.com/">Handlebar</a> syntax. For more
information on the details of these formats, see their respective websites.</p>
<p>It will be easiest for us to look at these with an example, so let’s work with
one. Open up your <code>components/order_details/order_details.stache</code> file.
It should look like this:</p>
<pre><code class="language-html">{{#with order}}
  &lt;h3&gt;Thanks for your order {{name}}!&lt;/h3&gt;
  &lt;div&gt;
    &lt;label class=&quot;control-label&quot;&gt;Confirmation Number: {{_id}}&lt;/label&gt;
  &lt;/div&gt;

  &lt;h4&gt;Items ordered:&lt;/h4&gt;
  &lt;ul class=&quot;list-group panel&quot;&gt;
    {{#each items}}
      &lt;li class=&quot;list-group-item&quot;&gt;
        &lt;label&gt;
          {{name}} &lt;span class=&quot;badge&quot;&gt;${{price}}&lt;/span&gt;
        &lt;/label&gt;
      &lt;/li&gt;
    {{/each}}

    &lt;li class=&quot;list-group-item&quot;&gt;
      &lt;label&gt;Total &lt;span class=&quot;badge&quot;&gt;${{total}}&lt;/span&gt;&lt;/label&gt;
    &lt;/li&gt;
  &lt;/ul&gt;

  &lt;div&gt;&lt;label class=&quot;control-label&quot;&gt;Phone: {{phone}}&lt;/label&gt;&lt;/div&gt;
  &lt;div&gt;&lt;label class=&quot;control-label&quot;&gt;Address: {{address}}&lt;/label&gt;&lt;/div&gt;
{{/with}}
</code></pre>
<p><a name="context"></a></p>
<h2>Value lookup</h2>
<p>Assume for the moment that we have the following <code>customerOrder</code> map passed in to our Stache template:</p>
<pre><code>{
   customerNumber: 12543,
   customerType: 'Business',
   order: {
      name: 'Rudloph Steiner',
      _id: 837267,
      items: [
         {
            name: 'Garden Gnome',
            price: 23.70
         }
      ],
      total: 23.70,
      phone: '+49 170 345 6789',
      address: 'Beuselstrasse 15, Berlin',
      
      total: function(){
        var sum = 0;
        this.items.forEach(function(item){
          sum += item.price;
        });
        return sum;
      }
   }
}
</code></pre>
<p>If we want to show the <code>customerType</code> in a <code>&lt;span&gt;</code> we can do that in a stache template like the following:</p>
<pre><code>&lt;span&gt;{{customerType}}&lt;/span&gt;
</code></pre>
<p>What's inside the magic tags, in this case <code>customerType</code>, is a
<a href="../docs/can.stache.expressions.html#section_KeyLookupexpressions">key lookup expression</a>.
<a href="../docs/can.stache.key.html">Keys</a> are used to lookup values in the
<a href="../docs/can.view.Scope.html">template scope</a>.</p>
<p>A DOT(<code>.</code>) operator
can be used to lookup nested values.  For example:</p>
<pre><code>&lt;h3&gt;Thanks for your order {{order.name}}!&lt;/h3&gt;
&lt;span&gt;{{customerType}}&lt;/span&gt;
</code></pre>
<p>Similar to variable lookup JavaScript, a stache key lookup can search for a value in multiple places.
Each of these places is called a <strong>context</strong>.  The collection of all available contexts for a key lookup
is called a <a href="../docs/can.view.Scope.html">scope</a>.</p>
<p>The root context is
the data passed to a template. In this case, the root context is the <code>customerOrder</code>
object at the begining of this section.  This is why <code>{{customerType}}</code> outputs <code>Business</code>.</p>
<p><a href="../docs/can.stache.tags.section.html">Sections</a>
create contexts in Stache.  A section begins with <code>{{#EXPRESSION}}</code> or <code>{{^EXPRESSION}}</code>
and ends with <code>{{/EXPRESSION}}</code>.  In the following example <code>{{#with order}}</code>
defines a section whose scope lookup starts finding values in the
<code>customerOrder</code>'s <code>order</code> object first:</p>
<pre><code class="language-html">{{#with order}}
  &lt;h3&gt;Thanks for your order {{name}}!&lt;/h3&gt;
  &lt;span&gt;{{customerType}}&lt;/span&gt;
{{#with order}}
</code></pre>
<p>In between <code>{{#with order}}</code> and <code>{{/with}}</code>, the scope's contexts look like:</p>
<pre><code>[
  customerOrder.order,
  customerOrder
]
</code></pre>
<p>The top of the scope is called the <strong>current context</strong>.  In this case it is <code>customerOrder.order</code>.</p>
<p>When <code>{{name}}</code> is looked up, it will first look for <code>name</code> on the <strong>current context</strong>.  As that value
exists, <code>Rudloph Steiner</code> will be returned.</p>
<p>When <code>{{customerType}}</code> is looked up, it will look for <code>customerType</code> on the <strong>current context</strong>.  As
that value does not exist, the next context, <code>customerOrder</code>, will be searched. The value of
<code>customerOrder.customerType</code> will be returned.</p>
<p>From within a given scope, you can reference the <strong>current context</strong> or control which context
should be used to find values.</p>
<p>See examples below:</p>
<pre><code class="language-html">{{#with order}}
   &lt;div&gt;My Current Context Object: {{.}}&lt;/div&gt; &lt;!-- references the order object--&gt;
   &lt;div&gt;My Parent Context Object: {{../.}}&lt;/div&gt;  &lt;!-- references the customerOrder object--&gt; 
   &lt;div&gt;An Item on my Parent Context's Object: {{../customerNumber}}&lt;/div&gt;
   &lt;div&gt;My Parent's Parent Context Object: {{../../.}}&lt;/div&gt; &lt;!-- example of how you might access the parent of a parent --&gt;
{{/with}}
</code></pre>
<p><a name="enumeration"></a></p>
<h2>Looping over arrays</h2>
<p>Enumerating allows you to loop through the contents of an iterable item. We’ve done this above for
the options in our select dropdown. The <code>{{#each key}} ... {{/each}}</code> tag set
is used to iterate over an enumerable collection, such as an array. In the
example above, we are looping over an array of objects. As with <a href="#context">sections</a>,
the properties of the objects we are iterating over are accessible
from data keys inside the <code>#each</code> scope without dot notation. In the example
above, we saw:</p>
<pre><code class="language-html">{{#each items}}
  &lt;li class=&quot;list-group-item&quot;&gt;
    &lt;label&gt;
      {{name}} &lt;span class=&quot;badge&quot;&gt;${{price}}&lt;/span&gt;
    &lt;/label&gt;
  &lt;/li&gt;
{{/each}}
</code></pre>
<p>Because the context of the <code>{{#each}}</code> block is <code>items</code>, we can reference
the <code>name</code> and <code>price</code> properties of <code>items</code> directly&mdash;i.e, we don't need to
write <code>{{items.name}}</code> or <code>{{items.price}}</code>, we can just write <code>{{name}}</code> or <code>{{price}}</code>.</p>
<p>Call expressions can also be passed
to <a href="../docs/can.stache.helpers.each.html">#each</a>. For example, a ViewModel might
have a method to get menu items for a particular menu like <code>&quot;dinner&quot;</code> or
<code>&quot;lunch&quot;</code> like:</p>
<pre><code>var OrderViewModel = can.Map.extend({
  itemsForMenuType: function(type){
    return this.attr(&quot;menu.items&quot;).filter(function(item){
      return item.attr(&quot;type&quot;) === type;
    })
  }
})
</code></pre>
<p>Call this method and return its result to <code>#each</code> like:</p>
<pre><code>{{#each itemsForMenuType(&quot;lunch&quot;)}}
  &lt;li&gt;...&lt;/li&gt;
{{/each}}
</code></pre>
<p>Note that <a href="../docs/can.stache.tags.section.html">#key</a> can also
be used to loop through objects with enumerable properties. In general,
<a href="../docs/can.stache.helpers.each.html">#each</a> should be used if the key references
<a href="../docs/can.List.html">can.List</a> or Arrays that have or often have incremental updates. <a href="../docs/can.stache.tags.section.html">#key</a>
should be used when the list is replaced by a list with items that look
nothing like the previous list's items.</p>
<p><a name="conditionallogic"></a></p>
<h2>Conditional Logic</h2>
<p>Stache templates have a limited capacity for conditional logic. Open up your
<code>main.stache</code> file. It should look like this:</p>
<pre><code>{{&gt; header.stache}}

{{#eq page &quot;home&quot;}}
  {{&gt; home.stache}}
{{/eq}}

{{#eq page &quot;restaurants&quot;}}
  {{#if slug}}
    {{#eq action 'order'}}
      &lt;pmo-order {(slug)}=&quot;slug&quot;&gt;&lt;/pmo-order&gt;
    {{/eq}}
    {{^if action}}
      &lt;pmo-restaurant-details {(slug)}=&quot;slug&quot;&gt;&lt;/pmo-restaurant-details&gt;
    {{/if}}
  {{else}}
    &lt;pmo-restaurant-list&gt;&lt;/pmo-restaurant-list&gt;
  {{/if}}
{{/eq}}

{{#eq page &quot;orders&quot;}}
  &lt;pmo-order-history&gt;&lt;/pmo-order-history&gt;
{{/eq}}
</code></pre>
<p>You’ll see two different helpers: <code>eq</code> and <code>if</code>. The <code>eq</code> helper takes two
arguments: the first being the key that is within the current section, and
the second a value to compare to the first argument to see if they are equal.
The <code>if</code> helper checks for one truthy argument before rendering what the
<code>if</code> block contains.</p>
<p>You might also notice the use of the <code>^</code> character, which will render the
section if the result of the helper is false. In other words, you can write
<code>{{^if action}}content{{/if}}</code> instead of <code>{{#if action}}{{else}}content{{/if}}</code></p>
<p>In general, it’s best to keep complex logic out of your templates. Their main function
should be to display data from the view model. If you need to use more complex logic
to display data in your templates, you can use a helper. Helpers are not covered in detail
in this guide; but you can get more information on them in the API: <a href="../docs/can.Component.prototype.helpers.html">Helpers</a></p>
<p><a name="partials"></a></p>
<h2>Partials</h2>
<p>You can nest templates in other templates by using partials. Partials inherit
the context from which they are called. They are evaluated at render time, so you
should be careful to avoid infinite loops. To include a partial, put its URL or
ID inside <code>{{&gt; }}</code>.</p>
<p>In our example above, you can see that <code>{{&gt; header.stache}}</code> includes the
<code>header.stache</code> file into the template.</p>
<hr />
<p><span class="pull-left"><a href="TheDefinePlugin.html">&lsaquo; The Define Plugin</a></span>
<span class="pull-right"><a href="AppStateAndRouting.html">App State and Routing &rsaquo;</a></span></p>
</div>

		</section>
		
		

		

		
	
	
	</article>
	
	

</div>






	
	<footer>
		<nav class="container">
			<a class="brand" href="index.html"></a>
			<ul class='nav'>
				<li >
	              <a href="../index.html">Home</a>
	            </li>
		        <li class='active'><a href='index.html'>guides</a></li>
		        <li><a href='../docs/index.html'>api</a></li>
		        <li>
	              <a href="http://blog.bitovi.com/category/open-source/">Blog</a>
	            </li>
		        <li >
	              <a href="../download.html">Download</a>
	            </li>
            </ul>
		</nav>
	</footer>
	


    <script type="text/javascript">

	  var _gaq = _gaq || [];
	  _gaq.push(['_setAccount', 'UA-2302003-11']);
	  _gaq.push(['_setDomainName', 'canjs.com']);
	  _gaq.push(['_setAllowLinker', true]);
	  _gaq.push(['_trackPageview']);

	  (function() {
	  var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
	  ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
	  var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
	  })();

	</script>

	<script type="text/javascript">
		var docObject = {"type":"page","name":"StacheTemplates","src":"guides/getting-started-tutorial/stache-templates.md","description":"","title":"Stache Templates","parent":"Tutorial","order":5,"disabletableofcontents":true,"comment":" ","ignoreTemplateRender":true,"templates":"/Users/kevin/dev/canjs.com/theme/templates","static":"/Users/kevin/dev/canjs.com/theme/static","versionsSelectText":"CanJS v<%= version %>","glob":{"pattern":"{guides/*.md,guides/**/*.md,*.md}","ignore":"{node_modules,bower_components}/**/*","cwd":"/Users/kevin/dev/canjs.com/can"},"dest":"/Users/kevin/dev/canjs.com/guides","generators":["html"],"urls":{"builderData":"https://bitbuilder.herokuapp.com/canjs","builder":"https://bitbuilder.herokuapp.com/can.custom.js","bithub":"http://bitovi.bithub.com/api/v1/events/","cdn":"//canjs.com/release/","github":"https://github.com/bitovi/canjs.com"},"versions":[{"branch":"major","number":"3.0-pre"},{"branch":"master","number":"2.3"},{"number":"2.2"},{"number":"2.1"},{"number":"1.1"}],"defaultDownloadVersion":"2.3.28","docConfigDest":"../documentjs.json","project":{"version":"2.3","name":"canjs","source":"git://github.com/canjs/canjs#2.3-legacy"}};
	</script>

	
		<script>
		  steal = {
		    instantiated: {
		      "bundles/static.css!$css" : null
		    }
		  }
		</script>
		<script type='text/javascript'
				data-main="static"
				data-config="./static/config.js"
				src="./static/steal.production.js"
		    		bundles-path="bundles"></script>
	

</body>

</html>
