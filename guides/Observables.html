<!DOCTYPE html>

<!--[if lt IE 7]>
<html class="no-js ie lt-ie9 lt-ie8 lt-ie7" lang="en">
<![endif]-->
<!--[if IE 7]>
<html class="no-js ie lt-ie9 lt-ie8" lang="en">
<![endif]-->
<!--[if IE 8]>
<html class="no-js ie lt-ie9" lang="en">
<![endif]-->
<!--[if IE 9]>
<html class="no-js ie ie9" lang="en">
<![endif]-->
<!--[if gt IE 9]><!-->
<html class="no-js" lang="en">
<!--<![endif]-->
<head>
	<meta charset="utf-8">
	<title>CanJS - Observables </title>
	<meta name="description" content="">
	<meta name="author" content="">

	
	<link rel="stylesheet" type="text/css" href="./static/bundles/static.css">
	
	<!--[if lt IE 9]>
   <script type="text/javascript" src="static/html5shiv.js"></script>
    <!--<![endif]-->
</head>

<body class="docs ">
	<header>
		<nav class="container">

			<div class="logo-menu">
				<a class="brand" href="../index.html">CanJS</a>
				<ul class="dropdown-menu">
				  <li><a href="http://donejs.com">DoneJS</a></li>
		          <li><a href="http://canjs.com" class="active">CanJS</a></li>
		          <li><a href="http://jquerypp.com">jQuery++</a></li>
		          <li><a href="http://stealjs.com">StealJS</a></li>
		          <li><a href="http://funcunit.com">FuncUnit</a></li>
		          <li><a href="http://documentjs.com">DocumentJS</a></li>
		        </ul>
			</div>

			<ul class="nav">
		        <li >
	              <a href="../index.html">Home</a>
                </li>
		       <li class='active'><a href='index.html'>guides</a></li>
		       <li><a href='../docs/index.html'>api</a></li>
		        <li class=" community-menu">
		          <a href="javascript://">Community</a>
		          <ul class="dropdown-menu">
		            <li><a href="http://forums.donejs.com/c/canjs">Forums</a></li>
		            <li><a href="https://www.npmjs.com/search?q=canjs">Plugins</a></li>
		            <li><a href="http://github.com/canjs/canjs">Github</a></li>
		            <li><a href="http://twitter.com/canjs">Twitter</a></li>
		            <li><a href="http://donejs.com/community.html">Meetups</a></li>
		          </ul>
		        </li>
		        <li>
	              <a href="http://blog.bitovi.com/category/open-source/">Blog</a>
                </li>
		        <li >
	              <a href="../download.html">Download</a>
                </li>
	      	</ul>

			<div class="pull-right">
				<div class="bitovi-menu">
					<a href="http://bitovi.com" class="bitovi icon-bits">Bitovi</a>
					<ul class="dropdown-menu">
						<li><a href="http://bitovi.com">Bitovi.com</a></li>
						<li><a href="http://bitovi.com/blog/">Blog</a></li>
						<li><a href="http://bitovi.com/design/">Design</a></li>
						<li><a href="http://bitovi.com/development/">Development</a></li>
						<li><a href="http://bitovi.com/training/">Training</a></li>
						<li><a href="http://bitovi.com/open-source/">Open Source</a></li>
						<li><a href="http://bitovi.com/people/">People</a></li>
						<li><a href="http://bitovi.com/contact/">Contact Us</a></li>
					</ul>
				</div>
			</div>

		</nav>
	</header>

	
<div class="container api">

	
	<nav class="sidebar">
		
		<h2 id="version">
	<select id='versions'></select>
</h2>
<ul class="api">
	<!-- First Level -->
	
	   <li class="search-container">
	   		<a href="Why.html" data-search="Why CanJS?">
				Why CanJS?
			</a>
			
	   </li>
	
	   <li class="search-container">
	   		<a href="Using.html" data-search="Setting up CanJS">
				Setting up CanJS
			</a>
			
	   </li>
	
	   <li class="search-container active">
	   		<a href="Tutorial.html" data-search="Getting Started Tutorial">
				Getting Started Tutorial
			</a>
			
				
	<ul class="primary-grouping">
		
			
				
				
					<li class="search-container  ">
						<a 	class="page" 
							href="Setup.html" 
							data-search="Setup">
							Setup
						</a>
						
					</li>
				
			
			
		
			
				
				
					<li class="search-container  ">
						<a 	class="page" 
							href="ApplicationDesign.html" 
							data-search="Application Design">
							Application Design
						</a>
						
					</li>
				
			
			
		
			
				
				
					<li class="search-container  ">
						<a 	class="page" 
							href="Constructors.html" 
							data-search="Constructors">
							Constructors
						</a>
						
					</li>
				
			
			
		
			
				
				
					<li class="search-container active  expanded">
						<a 	class="page" 
							href="Observables.html" 
							data-search="Observables">
							Observables
						</a>
						
							
						
					</li>
				
			
			
		
			
				
				
					<li class="search-container  ">
						<a 	class="page" 
							href="TheDefinePlugin.html" 
							data-search="The Define Plugin">
							The Define Plugin
						</a>
						
					</li>
				
			
			
		
			
				
				
					<li class="search-container  ">
						<a 	class="page" 
							href="StacheTemplates.html" 
							data-search="Stache Templates">
							Stache Templates
						</a>
						
					</li>
				
			
			
		
			
				
				
					<li class="search-container  ">
						<a 	class="page" 
							href="AppStateAndRouting.html" 
							data-search="App State and Routing">
							App State and Routing
						</a>
						
					</li>
				
			
			
		
			
				
				
					<li class="search-container  ">
						<a 	class="page" 
							href="Components.html" 
							data-search="Components">
							Components
						</a>
						
					</li>
				
			
			
		
			
				
				
					<li class="search-container  ">
						<a 	class="page" 
							href="ViewModels.html" 
							data-search="View Models">
							View Models
						</a>
						
					</li>
				
			
			
		
			
				
				
					<li class="search-container  ">
						<a 	class="page" 
							href="DataModelsAndFixtures.html" 
							data-search="Data Models and Fixtures">
							Data Models and Fixtures
						</a>
						
					</li>
				
			
			
		
			
				
				
					<li class="search-container  ">
						<a 	class="page" 
							href="Routing.html" 
							data-search="Routing">
							Routing
						</a>
						
					</li>
				
			
			
		
			
				
				
					<li class="search-container  ">
						<a 	class="page" 
							href="LoadingStates.html" 
							data-search="Loading States">
							Loading States
						</a>
						
					</li>
				
			
			
		
			
				
				
					<li class="search-container  ">
						<a 	class="page" 
							href="EventHandling.html" 
							data-search="Event Handling">
							Event Handling
						</a>
						
					</li>
				
			
			
		
			
				
				
					<li class="search-container  ">
						<a 	class="page" 
							href="WebServiceCommunication.html" 
							data-search="Web Service Communication">
							Web Service Communication
						</a>
						
					</li>
				
			
			
		
			
				
				
					<li class="search-container  ">
						<a 	class="page" 
							href="Recap.html" 
							data-search="Recap">
							Recap
						</a>
						
					</li>
				
			
			
		
	</ul>

			
	   </li>
	
	   <li class="search-container">
	   		<a href="Recipes.html" data-search="Recipes">
				Recipes
			</a>
			
	   </li>
	
	   <li class="search-container">
	   		<a href="contributing.html" data-search="How to Contribute">
				How to Contribute
			</a>
			
	   </li>
	
	   <li class="search-container">
	   		<a href="changelog.html" data-search="Changelog">
				Changelog
			</a>
			
	   </li>
	
	   <li class="search-container">
	   		<a href="license.html" data-search="License">
				License
			</a>
			
	   </li>
	
	   <li class="search-container">
	   		<a href="migrating.html" data-search="Migrating to 2.0">
				Migrating to 2.0
			</a>
			
	   </li>
	
	   <li class="search-container">
	   		<a href="roadmap.html" data-search="Roadmap">
				Roadmap
			</a>
			
	   </li>
	
</ul>
	</nav>
	
	
	
	<article class="content docs">
	
	
		
		<section class="title">
			<div class="heading">
<h1>Observables</h1>
	<ul class="tags">
		<li>page</li>
	</ul>
	
	
</div>

<div class="sub-heading">
	
	
		<span class="module">Observables</span>
	
	
	
	<span class="inherits">&nbsp;</span>
</div>

<ul class="links">
	
	
		<li><a href="https://github.com/canjs/canjs/tree/2.3-legacy/guides/getting-started-tutorial/observables.md">source</a></li>
	
	
	
</ul>
<br />
		</section>
		
		
		
		<section class="contents">
		</section>
		
		
		

		

		
			
		
		
		
		

		
		<section class="comment">
			<div class="getting-started">
<hr />
<p><strong>In this Chapter</strong></p>
<ul>
<li><code>can.Map</code>, and</li>
<li><code>can.List</code></li>
</ul>
<hr />
<p>Observables are the subjects in the
<a href="http://en.wikipedia.org/wiki/Observer_pattern">observer pattern</a>.
They let you create relationships between objects
where one object (or objects) listens for and responds to changes in another object.
Most of the core objects in CanJS are observables. Understanding how to effectively
work with observables lies at the heart of understanding how to build successful
CanJS applications.</p>
<p>In this section, we’ll review the two observables that make up the core of most CanJS objects:</p>
<ul>
<li><a href="../docs/can.Map.html"><code>can.Map</code></a> - Used for Objects.</li>
<li><a href="../docs/can.List.html"><code>can.List</code></a> - Used for Arrays.</li>
</ul>
<p><code>can.Map</code> and <code>can.List</code> are often extended to create observable types. For example,
<a href="../docs/can.Model.html">can.Model</a> and <a href="../docs/can.route.html">can.route</a> are
based on <code>can.Map</code>, and a <code>can.Component</code>’s <a href="../docs/can.Component.prototype.viewModel.html"><code>viewModel</code></a>
is a <code>can.Map</code>.</p>
<h2>Creating Instances</h2>
<p>To create a Map, call <code>new can.Map(object)</code>. This will give you a map
with the same properties and values as the <em>object</em> you passed in to the <code>can.Map</code> constructor.</p>
<p>To create a List, call <code>new can.List(array)</code>. This will give you a List with the same elements as the
<em>array</em> you passed into the <code>can.List</code> constructor.</p>
<pre><code>var pagination = new can.Map({page: 1, perPage: 25, count: 1388});
pagination.attr('perPage'); // 25

var hobbies = new can.List(['programming', 'bball', 'party rocking']);
hobbies.attr(2); // 'party rocking'
</code></pre>
<h2>Manipulating properties</h2>
<p>The <a href="../docs/can.Map.prototype.attr.html"><code>attr</code></a> method is
used to read a property from, or write a property to a <code>can.Map</code> or <code>can.List</code>.
While you can read the properties of a <code>can.Map</code> or <code>can.List</code> directly off
of the object, to take advantage of the observable functionality you must
use the <code>.attr</code> syntax.</p>
<pre><code>var pagination = new can.Map({page: 1, perPage: 25, count: 1388});

pagination.attr('perPage');     // 25
pagination.attr('perPage', 50);
pagination.attr('perPage');     // 50

pagination.attr({page: 10, lastVisited: 1});
pagination.attr(); // {page: 10, perPage: 50, count: 1388, lastVisited: 1}
</code></pre>
<p>Properties can be removed by using <a href="../docs/can.Map.prototype.removeAttr.html"><code>removeAttr</code></a>,
which is equivalent to the <code>delete</code> keyword:</p>
<pre><code>pagination.removeAttr('count');
pagination.attr(); // {page: 10, perPage: 50, lastVisited: 1}
</code></pre>
<h2>Extending a Map</h2>
<p>Extending a <code>can.Map</code> (or <code>can.List</code>) lets you create custom observable
types. The following extends <code>can.Map</code> to create a Paginate type that
has a <code>.next()</code> method:</p>
<pre><code>Paginate = can.Map.extend({
  define: {
    limit: {
      value: 100
    },
    offset: {
      value: 100
    },
    count: {
      value: Infinity
    }
  },
  next: function() {
    this.attr('offset', this.attr('offset') + this.attr('limit') );
  }
});

var pageInfo = new Paginate();
pageInfo.attr(&quot;offset&quot;) //-&gt; 100

pageInfo.next();

pageInfo.attr(&quot;offset&quot;) //-&gt; 200
</code></pre>
<h2>Responding to changes</h2>
<p>When a property on a Map is changed with <code>attr</code>, it will emit an event with the
name of the changed property.  You can <a href="../docs/can.Map.prototype.bind.html">bind</a>
to those events and perform some action:</p>
<pre><code>pagination.bind('page', function(event, newVal, oldVal) {
    newVal; // 11
    oldVal; // 10
    
    $(&quot;#page&quot;).text(&quot;Page: &quot;+newVal);
});

pagination.attr('page', 11);
</code></pre>
<p>Although <code>bind</code> and its corresponding <code>unbind</code> method exist, <strong>there's almost no
reason to ever use them!</strong>  This is because there are better ways to perform
the common actions that would require binding to an observable.</p>
<p>For example, <code>stache</code> templates will automatically update when an observable changes:</p>
<pre><code>var template = can.stache(&quot;&lt;span id='page'&gt;{{page}}&lt;/span&gt;&quot;);
$(&quot;body&quot;).append(template(pagination));

document.getElementById(&quot;page&quot;).innerHTML //-&gt; &quot;11&quot;

pagination.attr('page', 12);

document.getElementById(&quot;page&quot;).innerHTML //-&gt; &quot;12&quot;
</code></pre>
<p>The other common use case is to create some new, derived value.  <a href="../docs/can.compute.html">can.compute</a>
or <a href="../docs/can.Map.prototype.define.get.html">define getters</a> lets you use functional
(and reactive) programming techniques to derive new values from source
state.</p>
<p>For example, we can create a virtual <code>page</code> observable that derives its value from the
<code>offset</code> and <code>limit</code>:</p>
<pre><code>var pagination = new Paginate({
  limit: 10,
  offset: 20
});

var page = can.compute(function(){
  return Math.floor(pagination.attr('offset') / 
                    pagination.attr('limit')) + 1;
});

page() //-&gt; 3

page.bind(&quot;change&quot;, function(ev, newValue){
  newValue //-&gt; 4
});

pagination.attr(&quot;offset&quot;,30);
</code></pre>
<p>In this example <code>page</code> will automatically be updated when either <code>offset</code> or <code>limit</code> change.</p>
<p>However, <code>page</code> is more commonly created as a &quot;virtual&quot; property of the <code>Paginate</code> Map type
using a <a href="../docs/can.Map.prototype.define.get.html">define getter</a>:</p>
<pre><code>Paginate = can.Map.extend({
  define: {
    ...
    page: {
      get: function() {
        return Math.floor(this.attr('offset') / this.attr('limit')) + 1;
      }
    }
  },
  ...
});

var pageInfo = new Paginate({
  limit: 10,
  offset: 20,
  count: 30
});
pageInfo.attr(&quot;page&quot;) //-&gt; 3

pageInfo.bind(&quot;page&quot;, function(ev, newVal){
  newVal //-&gt; 4
});

pageInfo.next();
</code></pre>
<p>Using computes and define getters are very similar to using functional-reactive programming
event streams.  Given some source state, they are able to derive and combine it into new values.</p>
<p>Computes and define getters are easier, but less powerful than event streams.  Computes
and define getters only respond to changes in values where event streams
are also able to respond to events. However, computes and define getters
are eaiser to express and automatically manage subscriptions to source values.</p>
<p>For example, consider deriving a total for one of two menus depending on the time
of day:</p>
<pre><code>var lunch = new can.List([
  {name: &quot;nachos&quot;, price: 10.25},
  {name: &quot;water&quot;, price: 0},
  {name: &quot;taco&quot;, price: 3.25}
]);

var dinner = new can.List([
  {name: &quot;burrito&quot;, price: 12.25},
  {name: &quot;agua&quot;, price: 1.20}
]);

var timeOfDay = can.compute(&quot;lunch&quot;);

var total = can.compute(function(){
  var list = timeOfDay() === &quot;lunch&quot; ? lunch : dinner;
  var sum = 0;
  list.forEach(function(item){
    sum += item.attr(&quot;price&quot;);
  });
  return sum;
});
</code></pre>
<p>In this example, <code>total</code> will listen to not only <code>timeOfDay</code>, but
also when items are added or removed to <code>lunch</code> or <code>dinner</code>, and each item's
<code>price</code>.  Furthermore, it only listens to just what needs to be listened to. It will
listen to either <code>lunch</code> or <code>dinner</code>, but not both.</p>
<p>In the <a href="TheDefinePlugin.html">next chapter</a> we'll expand on the use of the define plugin
and show how it can handle asyncronous derived data like AJAX requests.</p>
<h2>Iterating though a Map</h2>
<p>If you want to iterate through the properties on a Map, use <code>each</code>:</p>
<pre><code>var pagination = new can.Map({page: 10, perPage: 25, count: 1388});

pagination.each(function(val, key) {
    console.log(key + ': ' + val);
});

// The console shows:
// page: 10
// perPage: 25
// count: 1388
</code></pre>
<h2>Observable Arrays</h2>
<p>CanJS also provides observable arrays with <code>can.List</code>.
<code>can.List</code> inherits from <code>can.Map</code>. A <code>can.List</code> works much the same way a
<code>can.Map</code> does, with the addition of methods useful for working with
arrays:</p>
<ul>
<li><a href="../docs/can.List.prototype.indexOf.html"><code>indexOf</code></a>, which looks for an item in a
List.</li>
<li><a href="../docs/can.List.prototype.pop.html"><code>pop</code></a>, which removes the last item from a
List.</li>
<li><a href="../docs/can.List.prototype.push.html"><code>push</code></a>, which adds an item to the end of a
List.</li>
<li><a href="../docs/can.List.prototype.shift.html"><code>shift</code></a>, which removes the first item from
a List.</li>
<li><a href="../docs/can.List.prototype.unshift.html"><code>unshift</code></a>, which adds an item to the front
of a List.</li>
<li><a href="../docs/can.List.prototype.splice.html"><code>splice</code></a>, which removes and inserts items
anywhere in a List.</li>
</ul>
<p>When these methods are used to modify a List events are
emitted that you can listen for, as well. See <a href="../docs/can.List.html">the API for Lists</a> for more
information.</p>
<p><span class="pull-left"><a href="ApplicationFoundations.html">&lsaquo; Application Foundations</a></span>
<span class="pull-right"><a href="TheDefinePlugin.html">The Define Plugin &rsaquo;</a></span></p>
</div>

		</section>
		
		

		

		
	
	
	</article>
	
	

</div>






	
	<footer>
		<nav class="container">
			<a class="brand" href="index.html"></a>
			<ul class='nav'>
				<li >
	              <a href="../index.html">Home</a>
	            </li>
		        <li class='active'><a href='index.html'>guides</a></li>
		        <li><a href='../docs/index.html'>api</a></li>
		        <li>
	              <a href="http://blog.bitovi.com/category/open-source/">Blog</a>
	            </li>
		        <li >
	              <a href="../download.html">Download</a>
	            </li>
            </ul>
		</nav>
	</footer>
	


    <script type="text/javascript">

	  var _gaq = _gaq || [];
	  _gaq.push(['_setAccount', 'UA-2302003-11']);
	  _gaq.push(['_setDomainName', 'canjs.com']);
	  _gaq.push(['_setAllowLinker', true]);
	  _gaq.push(['_trackPageview']);

	  (function() {
	  var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
	  ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
	  var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
	  })();

	</script>

	<script type="text/javascript">
		var docObject = {"type":"page","name":"Observables","src":"guides/getting-started-tutorial/observables.md","description":"","title":"Observables","parent":"Tutorial","order":3,"comment":" ","disabletableofcontents":true,"ignoreTemplateRender":true,"templates":"/Users/kevin/dev/canjs.com/theme/templates","static":"/Users/kevin/dev/canjs.com/theme/static","versionsSelectText":"CanJS v<%= version %>","glob":{"pattern":"{guides/*.md,guides/**/*.md,*.md}","ignore":"{node_modules,bower_components}/**/*","cwd":"/Users/kevin/dev/canjs.com/can"},"dest":"/Users/kevin/dev/canjs.com/guides","generators":["html"],"urls":{"builderData":"https://bitbuilder.herokuapp.com/canjs","builder":"https://bitbuilder.herokuapp.com/can.custom.js","bithub":"http://bitovi.bithub.com/api/v1/events/","cdn":"//canjs.com/release/","github":"https://github.com/bitovi/canjs.com"},"versions":[{"branch":"major","number":"3.0-pre"},{"branch":"master","number":"2.3"},{"number":"2.2"},{"number":"2.1"},{"number":"1.1"}],"defaultDownloadVersion":"2.3.28","docConfigDest":"../documentjs.json","project":{"version":"2.3","name":"canjs","source":"git://github.com/canjs/canjs#2.3-legacy"}};
	</script>

	
		<script>
		  steal = {
		    instantiated: {
		      "bundles/static.css!$css" : null
		    }
		  }
		</script>
		<script type='text/javascript'
				data-main="static"
				data-config="./static/config.js"
				src="./static/steal.production.js"
		    		bundles-path="bundles"></script>
	

</body>

</html>
