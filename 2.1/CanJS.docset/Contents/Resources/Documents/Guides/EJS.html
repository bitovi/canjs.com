<!DOCTYPE html>

<html class="no-js" lang="en">
<head>
  <meta charset="utf-8">
  <title>EJS</title>
  <meta name="description" content="">
  <meta name="author" content="">

  <link rel="stylesheet" type="text/css" 
    
      href='./static/production.css'
     />
</head>

<body class="guides">

  <div class="container api">
	<article class="content docs" style="border: 1px solid #d5d5d5">
		<section class="title">
			<div class="heading">
<h1>EJS</h1>
	<ul class="tags">
		<li>page</li>
	</ul>
	
	
	
		<span class="module">EJS</span>
	
	
	
	
</div>

<div class="sub-heading">
	
	<span class="inherits">&nbsp;</span>
</div>

<br />
		</section>

		<section class="contents">
		</section>

		

		<section class="description">
			
		</section>

		

		
		
		
		

		
		<section class="comment">
			<p><a href="../docs/can.ejs.html">EJS</a> is CanJS's default template language, which provides live
binding when used with Observes. EJS is very easy to use; you write the HTML you
want to be in the template, along with a few magic tags where you want dynamic
behavior.</p>

<p>Here's an example of a template that might render a list of Todos:</p>

<pre><code class="lang-javascript">&lt;script type="text/ejs" id="todoList">
<% for(var i = 0; i < todos.length; ++i) { %>
    &lt;li><%= this[i].attr('description') &lt;/li>
<% } %>
&lt;/script></code></pre>

<p>And you can use <code>can.view</code> to render the template:</p>

<pre><code class="lang-javascript">Todo.findAll({}, function(todos) {
    document.getElementById('list')
        .appendChild(can.view('todoList', todos));
});</code></pre>

<p>As you can see from the template and the call to <code>can.view</code>, the <code>todos</code>
object becomes <code>this</code> inside the template. EJS can also access the properties
of the <code>this</code> object without having to prefix it with <code>this.</code>:</p>

<pre><code class="lang-javascript">&lt;script type="text/ejs" id="todosAndUser">
&lt;h2> <%= user.attr('name') %>&lt;/h2>
<% for(var i = 0; i < todos.length; ++i) { %>
    &lt;li><%= this[i].attr('description') &lt;/li>
<% } %>
&lt;/script></code></pre>

<p>Which can be inserted in the document with:</p>

<pre><code class="lang-javascript">can.view('todosAndUser', {
    todos: Todo.findAll(),
    user: User.findOne({id: 5})
}).then(function(frag) {
    document.getElementById('todos').appendChild(fragment);
});</code></pre>

<h2>Magic tags</h2>

<p>There are five kinds of magic tags used in EJS:</p>

<p><code>&lt;% %&gt;</code> will run any JavaScript code inside of it. This tag doesn't modify or
populate the template, but allows you to use for loops, if/else statements, 
switch statements, and variable declarations inside the EJS template. Because
almost any JavaScript code is valid in <code>&lt;% %&gt;</code>, EJS is incredibly powerful.</p>

<p>Due to constraints necessary for live binding to function, it is heavily
encouraged to only have one line of JS code per pair of EJS tags in order to
ensure that the correct scope is maintained.</p>

<pre><code class="lang-javascript"><% if(todos.attr('length') > 0) { %>
    &lt;div>You have no to-dos.&lt;/div>
<% } else { %>
    &lt;ul>
        <% todos.each(function(todo) { %>
        &lt;li><%= todo.attr('description') %>&lt;/li>
        <% }); %>
    &lt;/ul>
<% } %></code></pre>

<p><code>&lt;%= %&gt;</code> will evaluate a JavaScript statement and write the HTML-escaped result
into the populated template. For example, an EJS template like this:</p>

<pre><code class="lang-javascript">&lt;div>My favorite element is <%= '&lt;b>blink&lt;/b>' %>.&lt;/div></code></pre>

<p>will result in HTML like this:</p>

<pre><code class="lang-javascript">&lt;div>My favorite element is &amp;lt;b&amp;gt;blink&amp;lt;/b&amp;gt;.&lt;/div></code></pre>

<p>This is almost always the tag you want to use when writing values to your
template, because it protects you against <a href="http://en.wikipedia.org/wiki/Cross-site_scripting">cross-site scripting attacks</a>.</p>

<p><code>&lt;%== %&gt;</code> will evaluate a JavaScript statement and write the raw result into the
populated template. This is like <code>&lt;%= %&gt;</code> but without escaping the result first.
For example, an EJS template like this:</p>

<pre><code class="lang-javascript">&lt;div>My favorite element is <%== '&lt;b>blink&lt;/b>' %>.&lt;/div></code></pre>

<p>will result in HTML like this:</p>

<pre><code class="lang-javascript">&lt;div>My favorite element is &lt;b>blink&lt;/b>.&lt;/div></code></pre>

<p>The most common use of <code>&lt;%== %&gt;</code> is to include templates in other templates:</p>

<pre><code class="lang-javascript"><% todos.each(function(todo) { %>
    &lt;li><%== can.view.render('todoEJS', todo); %>&lt;/li>
<% }); %></code></pre>

<p>The other two magic tags are less commonly used and can be found in the
<a href="../docs/can.ejs.html">documentation for EJS</a>.</p>

<h2>Live binding</h2>

<p>Live binding will automatically update your EJS templates in the DOM whenever
the data they are populated with changes. To do this, populate your templates
with Observes and use <code>attr</code> to read properties. In this template, using
<code>attr</code> sets up live binding on the <code>description</code> property of <code>todo</code>:</p>

<pre><code class="lang-javascript">&lt;li><%= todo.attr('description') %>&lt;/li></code></pre>

<p>If you change the Todo's description, the template's output will automatically
update:</p>

<pre><code class="lang-javascript">todo.attr('description', 'Clean up the bathroom.');</code></pre>

<p>Live binding works by wrapping the code inside the magic tags with a function
to call when the attributes inside the magic tags change. This means that a
template like this will not work:</p>

<pre><code class="lang-javascript"><% for(var i = 0; i < todos.length; ++i) { %>
    &lt;li><%= todos[i].attr('name') %>&lt;/li>
<% } %></code></pre>

<p>This will not work because when the function wrapping <code>todos[i].attr('name')</code> is
called, <code>i</code> will still be <em>3</em> (as that is what <code>i</code> is set to after the loop is
run). You can fix this by using a closure and the <code>each</code> method of Observes:</p>

<pre><code class="lang-javascript"><% todos.each(function() { %>
    &lt;li><%= todo.attr('name') %>&lt;/li>
<% }); %></code></pre>

<p><code>each</code> will also watch the length of the list it is passed, so elements are
added or removed from it, it will update the output of the template.</p>

<h2>Element callbacks</h2>

<p>If the code inside <code>&lt;%= %&gt;</code> or <code>&lt;%== %&gt;</code> evaluates to a function, the function
will be called back with the element it's inside as its first argument. This is
useful to initialize functionality on an element within the template, like
starting an element hidden:</p>

<pre><code class="lang-javascript">&lt;img src="surprise.gif" <%= function(element) { element.style.display = 'none'; } %>/></code></pre>

<p>This is so common that EJS also supports <a href="http://wiki.ecmascript.org/doku.php?id=strawman:arrow_function_syntax">ECMAScript 5 arrow functions</a>
that get passed a library-wrapped NodeList containing the element. Because we
are using jQuery, the example above can be more simply written like this:</p>

<pre><code class="lang-javascript">&lt;img src="surprise.gif" <%= (el) -> el.hide() %>/></code></pre>

<p>You can use this functionality to easily attach data to an element. A common
reason to do this is to attach a Model to the element that represents it:</p>

<pre><code class="lang-javascript"><% todos.each(function(todo) { %>
&lt;li <%= (el) -> can.data(el, 'todo', todo) %>>
    <%= todo.attr('description') %>
&lt;/li>
<% }) %></code></pre>
		</section>
		

		
	</article>
</div>

<script type="text/javascript">
	var docData = {"type":"page","name":"EJS","description":"","title":"EJS","parent":"Tutorial","order":4,"comment":" ","src":"can/guides/ejs.md","id":9};

	console.log(docData);
</script>



  <footer>
    <nav class="container">
      <a class="brand javascriptmvc" href="#"></a>
    </nav>
  </footer>
  <script type="text/javascript">
    window.docConfig = {"debug":false,"enableSearch":true,"parent":"guides","layout":"documentjs/site/templates/page.mustache","docs":"documentjs/site/templates/docs.mustache","root":"..","out":"2.1/docset/Contents/Resources/Documents/Guides","page":"guides","markdown":["can/guides","can/changelog.md","can/contributing.md","can/license.md"],"package":{"name":"CanJS","description":"MIT-licensed, client-side, JavaScript framework that makes building rich web applications easy.","version":"2.1.3","author":{"name":"Bitovi","email":"contact@bitovi.com","web":"http://bitovi.com/"},"homepage":"http://canjs.us/","repository":{"type":"git","url":"git@github.com:bitovi/canjs.git","github":"https://github.com/bitovi/canjs"},"devDependencies":{"grunt":"~0.4.0","grunt-string-replace":"~0.2.2","grunt-contrib-qunit":"~0.5.1","grunt-contrib-connect":"~0.3.0","bitovi-tools":"https://github.com/bitovi/bitovi-tools/tarball/master","steal":"https://github.com/bitovi/steal-build/tarball/master","grunt-contrib-uglify":"~0.2.1","grunt-contrib-clean":"~0.5.0","grunt-shell":"~0.5.0","grunt-release-steps":"~0.3.7","bower":"~1.3.8","grunt-contrib-jshint":"~0.8.0","grunt-jsbeautifier":"~0.2.6","grunt-docco2":"git://github.com/shcarrico/grunt-docco.git#e4de54886ed5c421b2e26e7a2aeba1f73e889733","grunt-plato":"~0.2.1"},"scripts":{"test":"grunt test","install":"node node_modules/bower/bin/bower install"},"demos":["http://canjs.us/#examples","http://canjs.us/recipes"],"licenses":[{"type":"MIT","url":"http://opensource.org/licenses/mit-license.php"}],"dependencies":{"grunt-cli":"~0.1.7"}},"self":{"name":"canjs.com","description":"We can do JS better.","version":"0.2.0","homepage":"http://canjs.com","author":{"name":"Bitovi","url":"http://bitovi.com/"},"repository":{"type":"git","url":"git://github.com/bitovi/canjs.com.git","github":"https://github.com/bitovi/canjs.com"},"bugs":{"url":"https://github.com/bitovi/canjs.com/issues"},"licenses":[{"type":"MIT","url":"https://github.com/bitovi/canjs.com/blob/master/LICENSE-MIT"}],"engines":{"node":">= 0.10.0"},"devDependencies":{"grunt":"~0.4.1","grunt-contrib-watch":"~0.3.1","grunt-contrib-less":"~0.5.0","documentjs":"https://github.com/bitovi/documentjs/tarball/node-generator","grunt-contrib-clean":"~0.4.1","grunt-docco2":"git://github.com/shcarrico/grunt-docco.git#options-passing","grunt-plato":"~0.2.1","grunt-jsbeautifier":"~0.2.6","grunt-shell":"~0.6.4","sqlite3":"~2.2.3","q":"~1.0.1"}},"builder":{"filename":"can.custom.js","banner":"/*!\n * <%= pkg.title || pkg.name %> - <%= pkg.version %>\n * <%= pkg.homepage %>\n * Copyright (c) <%= new Date().getFullYear() %> <%= pkg.author.name %>\n * <%= new Date().toUTCString() %>\n * Licensed <%= pkg.licenses[0].type %><% if(typeof url !== \"undefined\") { %>\n * Includes: <%= ids %>\n * Download from: <%= url %>\n<% } %> */\n","modules":{"can/component":{"name":"can.Component","description":"Custom elements and widgets","type":"core","isDefault":true},"can/construct":{"name":"can.Construct","description":"Inheritable constructor functions","type":"core","isDefault":true},"can/map":{"name":"can.Map","description":"Observables and key-value bindings","type":"core","isDefault":true},"can/list":{"name":"can.List","description":"Observables lists","type":"core","isDefault":true},"can/list/promise":{"name":"can.List.promise","description":"Promises on lists","type":"plugin"},"can/observe":{"name":"can.Observe","description":"Observables and key-value bindings","type":"core","isDefault":true,"hidden":true},"can/compute":{"name":"can.compute","description":"can.compute lets you make observable values","type":"core","isDefault":true},"can/model":{"name":"can.Model","description":"Observes connected to a RESTful JSON interface","type":"core","isDefault":true},"can/view":{"name":"can.view","description":"Template loading, caching, rendering","type":"core","isDefault":true},"can/view/ejs":{"name":"can.ejs","description":"Live-binding Embedded JavaScript","type":"plugin"},"can/view/stache":{"name":"can.stache","description":"High performance Mustache templates","type":"plugin"},"can/control":{"name":"can.Control","description":"Declarative event bindings","type":"core","isDefault":true},"can/route":{"name":"can.route","description":"Back button and bookmarking support","type":"core","isDefault":true},"can/control/route":{"name":"can.Control.route","description":"Declare routes in your Control","type":"core","isDefault":true},"can/view/mustache":{"name":"can.mustache","description":"Live-binding Handlebars and Mustache views","type":"core","isDefault":true},"can/route/pushstate":{"name":"can.route.pushstate","description":"can.route with pushstate","type":"plugin"},"can/model/queue":{"name":"can.Model.Queue","type":"plugin","description":"Queued requests to the server."},"can/construct/super":{"name":"can.Construct.super","type":"plugin","description":"Call super methods"},"can/construct/proxy":{"name":"can.Construct.proxy","type":"plugin","description":"Proxy construct methods"},"can/map/lazy":{"name":"can.Map.Lazy","type":"plugin","description":"Lazy initializing maps and lists"},"can/map/delegate":{"name":"can.Map.delegate","type":"plugin","description":"Listen to Observe attributes"},"can/map/setter":{"name":"can.Map.setter","type":"plugin","description":"Use setter methods on can.Map"},"can/map/attributes":{"name":"can.Map.attributes","type":"plugin","deprecated":true,"description":"Define Observe attributes"},"can/map/validations":{"name":"can.Map.validations","type":"plugin","description":"Validate Observe attributes"},"can/map/backup":{"name":"can.Map.backup","type":"plugin","description":"Backup and restore an Observes state"},"can/map/list":{"name":"can.Map.List","type":"plugin","description":"Live-updating mapped and filtered observe lists"},"can/map/define":{"name":"can.Map.define","type":"plugin","description":"Define rich attribute behavior"},"can/map/sort":{"name":"can.List.Sort","type":"plugin","description":"Sort observable lists"},"can/control/plugin":{"name":"can.Control.plugin","type":"plugin","description":"Registers a jQuery plugin function for Controls","configurations":["jquery","jquery-2"]},"can/view/modifiers":{"name":"can.view.modifiers","type":"plugin","description":"Use jQuery modifiers to render views","configurations":["jquery","jquery-2"]},"can/util/object":{"name":"can.Object","type":"plugin","description":"Helper methods for object comparison"},"can/util/fixture":{"name":"can.fixture","type":"plugin","description":"Intercepts an AJAX request and simulates the response with a file or function"},"can/view/bindings":{"name":"can.view.bindings","type":"core","isDefault":true,"hidden":true},"can/view/live":{"name":"can.view.live","type":"core","isDefault":true,"hidden":true},"can/view/scope":{"name":"can.view.Scope","type":"core","isDefault":true,"hidden":true},"can/util/string":{"name":"can.util.string","type":"core","isDefault":true,"hidden":true},"can/util/attr":{"name":"can.util.attr","type":"core","isDefault":true,"hidden":true}},"types":{"core":"CanJS core","plugin":"Plugins"},"pluginify":{"shim":{"can/lib/jquery.2.0.3.js":"jQuery","can/lib/jquery.1.10.2.js":"jQuery","can/bower_components/zepto/zepto.js":"Zepto","can/lib/mootools-core-1.4.5.js":"{}","can/util/dojo/dojo-1.8.1.js":"{}","can/lib/yui-3.7.3.js":"YUI"},"exports":{"can/util/can.js":"can"}},"configurations":{"jquery":{"description":"jQuery","isDefault":true,"library":"lib/jquery.1.10.2.js","steal":{"map":{"*":{"can/util/util.js":"can/util/jquery/jquery.js","jquery/jquery.js":"can/lib/jquery.1.10.2.js"}}}},"jquery-2":{"description":"jQuery (2.x)","hidden":true,"library":"lib/jquery.2.0.3.js","steal":{"map":{"*":{"can/util/util.js":"can/util/jquery/jquery.js","jquery/jquery.js":"can/lib/jquery.2.0.3.js"}}}},"zepto":{"description":"Zepto","library":"bower_components/zepto/zepto.js","steal":{"map":{"*":{"can/util/util.js":"can/util/zepto/zepto.js","zepto/zepto.js":"can/bower_components/zepto/zepto.js"}}}},"mootools":{"description":"Mootools","library":"lib/mootools-core-1.4.5.js","steal":{"map":{"*":{"can/util/util.js":"can/util/mootools/mootools.js","mootools/mootools.js":"can/lib/mootools-core-1.4.5.js"}}}},"yui":{"description":"YUI","library":"lib/yui-3.7.3.js","steal":{"map":{"*":{"can/util/util.js":"can/util/yui/yui.js","yui/yui.js":"can/lib/yui-3.7.3.js"}}}},"dojo":{"description":"Dojo","library":"util/dojo/dojo-1.8.1.js","steal":{"map":{"*":{"can/util/util.js":"can/util/dojo/dojo.js","dojo/dojo.js":"can/util/dojo/dojo-1.8.1.js"}}}}}},"url":{"builderData":"http://bitbuilder.herokuapp.com/canjs","builder":"http://bitbuilder.herokuapp.com/can.custom.js","bithub":"http://api.bithub.com/api/v1/events/","cdn":"//canjs.com/release/"},"static":"scripts/static","templates":"scripts/docset-templates","forceBuild":false,"minifyBuild":true,"versionsSrc":"../../versions.json","version":"2.1","isVersioned":true,"versions":[{"number":"2.1","branch":"master"},{"number":"2.0"},{"number":"1.1"}]};
    window.Bitovi = {
      URL: {
        BUILDER: 'http://bitbuilder.herokuapp.com/can.custom.js',
        BUILDER_DATA: 'http://bitbuilder.herokuapp.com/canjs',
        BITHUB: 'http://api.bithub.com/api/v1/events/',
        CDN: '//canjs.com/release/'
      }
    }
    steal = {
      productionId: "production.js",
      executed: ["documentjs/site/static/build/production.css"]
    }
  </script>
  <script 
  
    src="./static/steal.production.js"
  
    ></script>
</body>

</html>
