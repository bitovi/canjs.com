<!DOCTYPE html>

<html class="no-js" lang="en">
<head>
  <meta charset="utf-8">
  <title>Models</title>
  <meta name="description" content="">
  <meta name="author" content="">

  <link rel="stylesheet" type="text/css" 
    
      href='./static/production.css'
     />
</head>

<body class="guides">

  <div class="container api">
	<article class="content docs" style="border: 1px solid #d5d5d5">
		<section class="title">
			<div class="heading">
<h1>Models &amp; Retrieving Data</h1>
	<ul class="tags">
		<li>page</li>
	</ul>
	
	
	
		<span class="module">Models</span>
	
	
	
	
</div>

<div class="sub-heading">
	
	<span class="inherits">&nbsp;</span>
</div>

<br />
		</section>

		<section class="contents">
		</section>

		

		<section class="description">
			
		</section>

		

		
		
		
		

		
		<section class="comment">
			<p>Models are special Observes that connect to RESTful services. They come with a
set of methods designed to make it easy to manage changes remotely. To create
a Model class, call <code>can.Model</code> and supply it with specific static properties
that tell it how to interact with the server, along with any prototype
properties or helper methods the Model may need. The important static
properties are:</p>

<ul>
<li><a href="../docs/can.Model.findAll.html">findAll</a>, which describes how to get a group of
items.</li>
<li><a href="../docs/can.Model.findOne.html">findOne</a>, which describes how to get a specific
item.</li>
<li><a href="../docs/can.Model.create.html">create</a>, which describes how to save a new item.</li>
<li><a href="../docs/can.Model.update.html">update</a>, which describes how to update an
existing item.</li>
<li><a href="../docs/can.Model.destroy.html">destroy</a>, which describes how to delete an item.</li>
</ul>

<p>When accessing a straightforward RESTful API, creating a Model class and an
instance of that Model class might be as simple as this:</p>

<pre><code class="lang-javascript">var Todo = can.Model({
    findAll: 'GET /todos',
    findOne: 'GET /todos/{id}',
    create:  'POST /todos',
    update:  'PUT /todos/{id}',
    destroy: 'DELETE /todos/{id}'
}, {});

var dishesTask = new Todo({description: 'Do the dishes.'});</code></pre>

<p>Because Models are Observes, don't forget to set all your properties using <code>attr</code>.</p>

<h2>Talking to the server</h2>

<p>By supplying the <code>findAll</code>, <code>findOne</code>, <code>create</code>, <code>update</code>, and <code>destroy</code>
properties, you show a Model class how to communicate with the server. You can
call <code>findAll</code> and <code>findOne</code> on the Model class to retrieve Models and <code>save</code>
and <code>destroy</code> on Models to create, update, and delete them.</p>

<h3>Retrieving items from a server</h3>

<p><code>can.Model.findAll</code> retrieves a group of Models by making a call to a server.
Here's how you call <code>findAll</code> on our Todo class above:</p>

<pre><code class="lang-javascript">Todo.findAll({}, function(todos) {
    // todos is a can.Model.List of Todo Models.
}, function(xhr) {
    // handle errors
});</code></pre>

<p>This will make a <code>GET</code> request to <code>/todos</code>, which should return JSON that looks
similar to:</p>

<pre><code class="lang-javascript">{
    "data": [
        {"id":1, "description":"Do the dishes."},
        {"id":2, "description":"Mow the lawn."},
        {"id":3, "description":"Finish the laundry."}
    ]
}</code></pre>

<p><code>findAll</code> will also accept an array from the service, but <a href="http://haacked.com/archive/2008/11/20/anatomy-of-a-subtle-json-vulnerability.aspx">you probably should not be returning an array from a JSON service</a>.</p>

<p>When the service has returned, <code>findAll</code> will massage the data into Model
instances and put them in a can.Model.List (which is like a can.Observe.List
for Models). The resulting List will be passed to the success callback in its
second parameter. If there was an error, <code>findAll</code> will call the error
callback in its third parameter and pass it the XmlHttpRequest object used to
make the call.</p>

<p><code>findAll</code> returns a <a href="../docs/can.Deferred.html">can.Deferred</a> that will resolve to a Model
List of items if the call succeeds and rejects to the XmlHttpRequest object if
there is an error.</p>

<p><code>can.Model.findOne</code> works similarly to <code>findAll</code>, except that it retrieves a
single Model from a service:</p>

<pre><code class="lang-javascript">Todo.findOne({id: 1}, function(todo) {
    // todo is an instance of Todo
});</code></pre>

<p>This makes a <code>GET</code> request to <code>/todos/1</code>, which should return JSON that looks
similar to:</p>

<pre><code class="lang-javascript">{
    "id":1,
    "description":"Do the dishes"
}</code></pre>

<p><code>findOne</code> returns a Deferred that resolves to the Todo if the call succeeds and
rejects to the XmlHttpRequest object if there is an error.</p>

<h3>Modifying items</h3>

<p>You can call <a href="../docs/can.Model.prototype.save.html">save</a> on a Model instance to save it
back to the server. If the Model has an <strong>id</strong>, it will be updated using the
function specified under <code>update</code>. Otherwise, can.Model assumes the Model is new
and creates the item on the server using the function in <code>create</code>.</p>

<p>Either way, the success callback in the first parameter will be called on a
successful save with the updated Model; if an error occurs, the error callback
in the second parameter will be called with the XmlHttpRequest object. Like
<code>findAll</code>, <code>save</code> returns a Deferred that resolves to the updated Model on
success and rejects to the XmlHttpRequest object on failure.</p>

<pre><code class="lang-javascript">var shopping = new Todo({description: "Go grocery shopping."});
shopping.save(function(saved) {
    // saved is the saved Todo
    saved.attr('description', 'Remember the milk.');
    saved.save();
});</code></pre>

<p>In the code above, the first time <code>shopping.save()</code> is called, can.Model will
make a <code>POST</code> request to <code>/todos</code> with a request body of <code>description=Go
grocery shopping.</code>. When the response comes back, it should have an <strong>id</strong>
(say, 5) and that <strong>id</strong> property will be reflected in <code>todo</code>.</p>

<p>The second time <code>saved.save()</code> is called, <code>saved</code> has an <strong>id</strong>, so can.Model
will make a <code>PUT</code> request to <code>/todos/5</code> with a request body of
<code>description=Remember the milk.</code>.</p>

<h3>Deleting items</h3>

<p>When you need to delete a Model's counterpart on the server, just call <code>destroy</code>
on the Model, passing it success and error handlers just like <code>save</code>, except
that the success handler will be passed the Model that has been deleted.
<code>destroy</code> also retuns a Deferred, which resolves to the deleted Model and
rejects to the XmlHttpRequest object.</p>

<pre><code class="lang-javascript">var cats = new Todo({description: "Feed the cats."});
cats.save(function(saved) {
    saved.destroy(function(destroyed) {
        // destroyed is the Todo that was destroyed
    });
});</code></pre>

<p>When <code>destroy</code> is called in the above code, can.Model makes a <code>DELETE</code> request
to <code>/todos/6</code>.</p>

<h2>Listening to events</h2>

<p>Because Models are Observes, you can bind to the same events as on any other
Observe. In addition to those events, Models emit three new kinds of events:</p>

<ul>
<li><em>created</em>, when an instance is created on the server.</li>
<li><em>updated</em>, when an instance is updated on the server.</li>
<li><em>destroyed</em>, when an instance is destroyed on the server.</li>
</ul>

<p>For example, here is how you listen for an instance being created on the server:</p>

<pre><code class="lang-javascript">var mop = new Todo({description: 'Mop the floor.'});
mop.bind('created', function(ev, created) {
    // created is the created Todo
});
mop.save();</code></pre>

<p>You can also bind directly onto the Model class to listen for any time <strong>any</strong>
instance is created, updated, or destroyed:</p>

<pre><code class="lang-javascript">Todo.bind('created', function(ev, created) {
    // created is the created Todo
});</code></pre>

<h2>Model Lists</h2>

<p>Model Lists (provided by <code>can.Model.List</code>) are Lists whose items are Models.
When one of a Model List's elements are destroyed, that element is removed from
the list.</p>

<pre><code class="lang-javascript">Todo.findAll({}, function(todos) {
    todos.length; // 5
    todos[0].destroy(function() {
        todos.length; // 4
    }
});</code></pre>
		</section>
		

		
	</article>
</div>

<script type="text/javascript">
	var docData = {"type":"page","name":"Models","description":"","title":"Models & Retrieving Data","parent":"Tutorial","order":2,"comment":" ","src":"can/guides/models.md","id":13};

	console.log(docData);
</script>



  <footer>
    <nav class="container">
      <a class="brand javascriptmvc" href="#"></a>
    </nav>
  </footer>
  <script type="text/javascript">
    window.docConfig = {"debug":false,"enableSearch":true,"parent":"guides","layout":"documentjs/site/templates/page.mustache","docs":"documentjs/site/templates/docs.mustache","root":"..","out":"2.1/docset/Contents/Resources/Documents/Guides","page":"guides","markdown":["can/guides","can/changelog.md","can/contributing.md","can/license.md"],"package":{"name":"CanJS","description":"MIT-licensed, client-side, JavaScript framework that makes building rich web applications easy.","version":"2.1.3","author":{"name":"Bitovi","email":"contact@bitovi.com","web":"http://bitovi.com/"},"homepage":"http://canjs.us/","repository":{"type":"git","url":"git@github.com:bitovi/canjs.git","github":"https://github.com/bitovi/canjs"},"devDependencies":{"grunt":"~0.4.0","grunt-string-replace":"~0.2.2","grunt-contrib-qunit":"~0.5.1","grunt-contrib-connect":"~0.3.0","bitovi-tools":"https://github.com/bitovi/bitovi-tools/tarball/master","steal":"https://github.com/bitovi/steal-build/tarball/master","grunt-contrib-uglify":"~0.2.1","grunt-contrib-clean":"~0.5.0","grunt-shell":"~0.5.0","grunt-release-steps":"~0.3.7","bower":"~1.3.8","grunt-contrib-jshint":"~0.8.0","grunt-jsbeautifier":"~0.2.6","grunt-docco2":"git://github.com/shcarrico/grunt-docco.git#e4de54886ed5c421b2e26e7a2aeba1f73e889733","grunt-plato":"~0.2.1"},"scripts":{"test":"grunt test","install":"node node_modules/bower/bin/bower install"},"demos":["http://canjs.us/#examples","http://canjs.us/recipes"],"licenses":[{"type":"MIT","url":"http://opensource.org/licenses/mit-license.php"}],"dependencies":{"grunt-cli":"~0.1.7"}},"self":{"name":"canjs.com","description":"We can do JS better.","version":"0.2.0","homepage":"http://canjs.com","author":{"name":"Bitovi","url":"http://bitovi.com/"},"repository":{"type":"git","url":"git://github.com/bitovi/canjs.com.git","github":"https://github.com/bitovi/canjs.com"},"bugs":{"url":"https://github.com/bitovi/canjs.com/issues"},"licenses":[{"type":"MIT","url":"https://github.com/bitovi/canjs.com/blob/master/LICENSE-MIT"}],"engines":{"node":">= 0.10.0"},"devDependencies":{"grunt":"~0.4.1","grunt-contrib-watch":"~0.3.1","grunt-contrib-less":"~0.5.0","documentjs":"https://github.com/bitovi/documentjs/tarball/node-generator","grunt-contrib-clean":"~0.4.1","grunt-docco2":"git://github.com/shcarrico/grunt-docco.git#options-passing","grunt-plato":"~0.2.1","grunt-jsbeautifier":"~0.2.6","grunt-shell":"~0.6.4","sqlite3":"~2.2.3","q":"~1.0.1"}},"builder":{"filename":"can.custom.js","banner":"/*!\n * <%= pkg.title || pkg.name %> - <%= pkg.version %>\n * <%= pkg.homepage %>\n * Copyright (c) <%= new Date().getFullYear() %> <%= pkg.author.name %>\n * <%= new Date().toUTCString() %>\n * Licensed <%= pkg.licenses[0].type %><% if(typeof url !== \"undefined\") { %>\n * Includes: <%= ids %>\n * Download from: <%= url %>\n<% } %> */\n","modules":{"can/component":{"name":"can.Component","description":"Custom elements and widgets","type":"core","isDefault":true},"can/construct":{"name":"can.Construct","description":"Inheritable constructor functions","type":"core","isDefault":true},"can/map":{"name":"can.Map","description":"Observables and key-value bindings","type":"core","isDefault":true},"can/list":{"name":"can.List","description":"Observables lists","type":"core","isDefault":true},"can/list/promise":{"name":"can.List.promise","description":"Promises on lists","type":"plugin"},"can/observe":{"name":"can.Observe","description":"Observables and key-value bindings","type":"core","isDefault":true,"hidden":true},"can/compute":{"name":"can.compute","description":"can.compute lets you make observable values","type":"core","isDefault":true},"can/model":{"name":"can.Model","description":"Observes connected to a RESTful JSON interface","type":"core","isDefault":true},"can/view":{"name":"can.view","description":"Template loading, caching, rendering","type":"core","isDefault":true},"can/view/ejs":{"name":"can.ejs","description":"Live-binding Embedded JavaScript","type":"plugin"},"can/view/stache":{"name":"can.stache","description":"High performance Mustache templates","type":"plugin"},"can/control":{"name":"can.Control","description":"Declarative event bindings","type":"core","isDefault":true},"can/route":{"name":"can.route","description":"Back button and bookmarking support","type":"core","isDefault":true},"can/control/route":{"name":"can.Control.route","description":"Declare routes in your Control","type":"core","isDefault":true},"can/view/mustache":{"name":"can.mustache","description":"Live-binding Handlebars and Mustache views","type":"core","isDefault":true},"can/route/pushstate":{"name":"can.route.pushstate","description":"can.route with pushstate","type":"plugin"},"can/model/queue":{"name":"can.Model.Queue","type":"plugin","description":"Queued requests to the server."},"can/construct/super":{"name":"can.Construct.super","type":"plugin","description":"Call super methods"},"can/construct/proxy":{"name":"can.Construct.proxy","type":"plugin","description":"Proxy construct methods"},"can/map/lazy":{"name":"can.Map.Lazy","type":"plugin","description":"Lazy initializing maps and lists"},"can/map/delegate":{"name":"can.Map.delegate","type":"plugin","description":"Listen to Observe attributes"},"can/map/setter":{"name":"can.Map.setter","type":"plugin","description":"Use setter methods on can.Map"},"can/map/attributes":{"name":"can.Map.attributes","type":"plugin","deprecated":true,"description":"Define Observe attributes"},"can/map/validations":{"name":"can.Map.validations","type":"plugin","description":"Validate Observe attributes"},"can/map/backup":{"name":"can.Map.backup","type":"plugin","description":"Backup and restore an Observes state"},"can/map/list":{"name":"can.Map.List","type":"plugin","description":"Live-updating mapped and filtered observe lists"},"can/map/define":{"name":"can.Map.define","type":"plugin","description":"Define rich attribute behavior"},"can/map/sort":{"name":"can.List.Sort","type":"plugin","description":"Sort observable lists"},"can/control/plugin":{"name":"can.Control.plugin","type":"plugin","description":"Registers a jQuery plugin function for Controls","configurations":["jquery","jquery-2"]},"can/view/modifiers":{"name":"can.view.modifiers","type":"plugin","description":"Use jQuery modifiers to render views","configurations":["jquery","jquery-2"]},"can/util/object":{"name":"can.Object","type":"plugin","description":"Helper methods for object comparison"},"can/util/fixture":{"name":"can.fixture","type":"plugin","description":"Intercepts an AJAX request and simulates the response with a file or function"},"can/view/bindings":{"name":"can.view.bindings","type":"core","isDefault":true,"hidden":true},"can/view/live":{"name":"can.view.live","type":"core","isDefault":true,"hidden":true},"can/view/scope":{"name":"can.view.Scope","type":"core","isDefault":true,"hidden":true},"can/util/string":{"name":"can.util.string","type":"core","isDefault":true,"hidden":true},"can/util/attr":{"name":"can.util.attr","type":"core","isDefault":true,"hidden":true}},"types":{"core":"CanJS core","plugin":"Plugins"},"pluginify":{"shim":{"can/lib/jquery.2.0.3.js":"jQuery","can/lib/jquery.1.10.2.js":"jQuery","can/bower_components/zepto/zepto.js":"Zepto","can/lib/mootools-core-1.4.5.js":"{}","can/util/dojo/dojo-1.8.1.js":"{}","can/lib/yui-3.7.3.js":"YUI"},"exports":{"can/util/can.js":"can"}},"configurations":{"jquery":{"description":"jQuery","isDefault":true,"library":"lib/jquery.1.10.2.js","steal":{"map":{"*":{"can/util/util.js":"can/util/jquery/jquery.js","jquery/jquery.js":"can/lib/jquery.1.10.2.js"}}}},"jquery-2":{"description":"jQuery (2.x)","hidden":true,"library":"lib/jquery.2.0.3.js","steal":{"map":{"*":{"can/util/util.js":"can/util/jquery/jquery.js","jquery/jquery.js":"can/lib/jquery.2.0.3.js"}}}},"zepto":{"description":"Zepto","library":"bower_components/zepto/zepto.js","steal":{"map":{"*":{"can/util/util.js":"can/util/zepto/zepto.js","zepto/zepto.js":"can/bower_components/zepto/zepto.js"}}}},"mootools":{"description":"Mootools","library":"lib/mootools-core-1.4.5.js","steal":{"map":{"*":{"can/util/util.js":"can/util/mootools/mootools.js","mootools/mootools.js":"can/lib/mootools-core-1.4.5.js"}}}},"yui":{"description":"YUI","library":"lib/yui-3.7.3.js","steal":{"map":{"*":{"can/util/util.js":"can/util/yui/yui.js","yui/yui.js":"can/lib/yui-3.7.3.js"}}}},"dojo":{"description":"Dojo","library":"util/dojo/dojo-1.8.1.js","steal":{"map":{"*":{"can/util/util.js":"can/util/dojo/dojo.js","dojo/dojo.js":"can/util/dojo/dojo-1.8.1.js"}}}}}},"url":{"builderData":"http://bitbuilder.herokuapp.com/canjs","builder":"http://bitbuilder.herokuapp.com/can.custom.js","bithub":"http://api.bithub.com/api/v1/events/","cdn":"//canjs.com/release/"},"static":"scripts/static","templates":"scripts/docset-templates","forceBuild":false,"minifyBuild":true,"versionsSrc":"../../versions.json","version":"2.1","isVersioned":true,"versions":[{"number":"2.1","branch":"master"},{"number":"2.0"},{"number":"1.1"}]};
    window.Bitovi = {
      URL: {
        BUILDER: 'http://bitbuilder.herokuapp.com/can.custom.js',
        BUILDER_DATA: 'http://bitbuilder.herokuapp.com/canjs',
        BITHUB: 'http://api.bithub.com/api/v1/events/',
        CDN: '//canjs.com/release/'
      }
    }
    steal = {
      productionId: "production.js",
      executed: ["documentjs/site/static/build/production.css"]
    }
  </script>
  <script 
  
    src="./static/steal.production.js"
  
    ></script>
</body>

</html>
